<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <div class="prev-next">
    <a class="prev" href="section23.html">Working on REPL</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section25.html">Compiled cache</a>
  </div>
  <section class="subsection"><h3 class="subsection">
    <a class="section.anchor" name="G25"><span class="section-number">2.4</span>Writing a library</a>
  </h3>
<p />Sagittarius provides 2 styles to write a library, one is R6RS style and other
one is R7RS style. Both styles are processed the same and users can use it
without losing code portability.
<p />Following example is written in R6RS style, for the detail of <code>library</code>
syntax please see the R6RS document described in bellow sections.
<pre class="codeblock">(library (foo)
  (export bar)
  (import (rnrs))

 (define bar 'bar) ) </pre> The library named <code>(foo)</code> must be saved the file
named <code>foo.scm</code>, <code>foo.ss</code>, <code>foo.sls</code> or <code>foo.sld</code> (I use
<code>.scm</code> for all examples) and located on the loading path, the value is
returned by calling <code>add-load-path</code> with 0 length string.
<p />If you want to write portable code yet want to use Sagittarius specific
functionality, then you can write implementation specific code separately using
<code>.sagittarius.scm</code>, <code>.sagittarius.ss</code>, <code>.sagittarius.sls</code> or
<code>.sagittarius.sld</code> extensions. This functionality is implemented almost
all R6RS implementation. If you use R7RS style library syntax, then you can
also use <code>cond-expand</code> to separate implementation specific
functionalities.
<p />If you don't want to share a library but only used in specific one, you can
write both in one file and name the file you want to show. For example;
<pre class="codeblock">(library (not showing)
  ;; exports all internal use procedures
  (export ...)
  (import (rnrs))
;; write procedures
...
)

(library (shared)
  (export shared-procedure ...)
  (import (rnrs) (not showing))
;; write shared procedures here
)
</pre>
Above script must be saved the file named <code>shared.scm</code>. The order of
libraries are important. Top most dependency must be the first and next is
second most, so on.
<p />Note: This style can hide some private procedures however if you want to write
portable code, some implementations do not allow you to write this style.
<p /></section>
  <div class="prev-next">
    <a class="prev" href="section23.html">Working on REPL</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section25.html">Compiled cache</a>
  </div>
  <hr>
  <div id="document-footer">
    <div id="footer-message">This document was generated by<i>Takashi Kato</i> with Sagittarius gendoc. </div>
    <div id="footer-date">Generated date: <i>2018-05-19T20:33:39+0200</i></div>
  </div>
</html>