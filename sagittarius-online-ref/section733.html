<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <div class="prev-next">
    <a class="prev" href="section732.html">(rfc :5322) - Internet message format library</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section734.html">(rfc cmac) - CMAC library</a>
  </div>
  <section class="subsection"><h3 class="subsection">
    <a class="section.anchor" name="rfc.base64"><span class="section-number">7.33</span>(rfc base64) - Base 64 encode and decode library</a>
  </h3>
<p /><div class="define">
    <span class="define-category">Library</span>
    <a name="(rfc base64)2536">
      <span class="name" name="(rfc base64)">(rfc base64)</span>
    </a>
  </div>
<div class="desc">This library provides Base 64 encoding and decoding procedures.</div>
<p /><section class="subsubsection"><h4 class="subsubsection">
    <a class="section.anchor" name="G2537"><span class="section-number">7.33.1</span>Encoding procedures</a>
  </h4>
<p /><div class="define"><span class="define-category">Function</span><a name="base64-encode2538">
    <span class="name" name="base64-encode">base64-encode</span>
  </a>
 <span class="args">in :key (line-width 76) (padding? #t)</span></div>
<div class="define"><span class="define-category">Function</span><a name="base64url-encode2539">
    <span class="name" name="base64url-encode">base64url-encode</span>
  </a>
 <span class="args">in :key (line-width #f) (padding? #f)</span></div>
<div class="desc"><var>in</var> must be either a bytevector or binary input port.
<p />Encodes given input <var>in</var> to Base 64 encoded bytevector.
<p />The keyword argument <var>line-width</var> specifies where the encode procedure
should put linefeed. If this is less than 1 or #f, encoder does not put
linefeed.
<p />The keyword argument <var>padding?</var> controls if the result encoded value
contains padding character <code>#\=</code> or not. If this is #f, then the result
value won't contain padding character.
<p />The <code>base64url-encode</code> encodes the given input to Base 64 URL safe
encoded bytevector. Which doesn't use <code>+</code> and <code>/</code>.
</div>
<p /><div class="define"><span class="define-category">Function</span><a name="base64-encode-string2540">
    <span class="name" name="base64-encode-string">base64-encode-string</span>
  </a>
 <span class="args">string :key (line-width 76) transcoder (padding? #t)</span></div>
<div class="define"><span class="define-category">Function</span><a name="base64url-encode-string2541">
    <span class="name" name="base64url-encode-string">base64url-encode-string</span>
  </a>
 <span class="args">string :key (line-width #f) transcoder (padding? #f)</span></div>
<div class="desc">Convenient procedure for string.
<p />Encodes given <var>string</var> to Base 64 encoded string.
<p />The keyword argument <var>transcoder</var> is used to convert given string to
bytevector. The converted bytevector will be passed to the <code>base64-encode</code>
procedure. The default value is a transcoder with UTF-8 codec with EOL
style none.
<p />The keyword argument <var>padding?</var> is the same as <code>base64-encode</code>.
<p />The <code>base64url-encode-string</code> encodes the given input to Base 64 URL safe
encoded bytevector. Which doesn't use <code>+</code> and <code>/</code>.
</div>
<p /><div class="define"><span class="define-category">Function</span><a name="open-base64-encode-input-port2542">
    <span class="name" name="open-base64-encode-input-port">open-base64-encode-input-port</span>
  </a>
 <span class="args">source :key (owner? #f) (line-width #f) (padding? #t)</span></div>
<div class="define"><span class="define-category">Function</span><a name="open-base64-encode-output-port2543">
    <span class="name" name="open-base64-encode-output-port">open-base64-encode-output-port</span>
  </a>
 <span class="args">sink :key (owner? #f) (line-width #f) (padding? #t)</span></div>
<div class="define"><span class="define-category">Function</span><a name="open-base64url-encode-input-port2544">
    <span class="name" name="open-base64url-encode-input-port">open-base64url-encode-input-port</span>
  </a>
 <span class="args">source :key (owner? #f) (line-width #f) (padding? #f)</span></div>
<div class="define"><span class="define-category">Function</span><a name="open-base64url-encode-output-port2545">
    <span class="name" name="open-base64url-encode-output-port">open-base64url-encode-output-port</span>
  </a>
 <span class="args">sink :key (owner? #f) (line-width #f) (padding? #f)</span></div>
<div class="desc">Creates binary Base64 encode input and output port, respectively.
<p /><var>source</var> must be binary inpurt port.
<p />The input port reads bytes from <var>source</var> and returns Base64 encoded
result.
<p /><var>sink</var> must be binary inpurt port.
<p />The output port puts encoded bytes to <var>sink</var>. The port must be closed
to finish the encoding process properly.
<p />The keyword argument <var>padding?</var> is the same as <code>base64-encode</code>.
<p />The <code>open-base64url-encode-input-port</code> and
<code>open-base64url-encode-output-port</code> encode to Base64 URL safe encode.
</div>
<p /></section><section class="subsubsection"><h4 class="subsubsection">
    <a class="section.anchor" name="G2546"><span class="section-number">7.33.2</span>Decoding procedures</a>
  </h4>
<p /><div class="define"><span class="define-category">Function</span><a name="base64-decode2547">
    <span class="name" name="base64-decode">base64-decode</span>
  </a> <span class="args">in</span></div>
<div class="define"><span class="define-category">Function</span><a name="base64url-decode2548">
    <span class="name" name="base64url-decode">base64url-decode</span>
  </a> <span class="args">in</span></div>
<div class="desc"><var>in</var> must be a bytevector or binary input port.
<p />Decode Base 64 encoded input <var>in</var> to original bytevector.
<p />The <code>base64url-decode</code> decodes Base64 URL safe encoded value.
</div>
<p /><div class="define"><span class="define-category">Function</span><a name="base64-decode-string2549">
    <span class="name" name="base64-decode-string">base64-decode-string</span>
  </a>
 <span class="args">string :key (transcoder (native-transcoder))</span></div>
<div class="define"><span class="define-category">Function</span><a name="base64url-decode-string2550">
    <span class="name" name="base64url-decode-string">base64url-decode-string</span>
  </a>
 <span class="args">string :key (transcoder (native-transcoder))</span></div>
<div class="desc">Convenient procedure.
<p />Decode Base 64 encoded string to original string. The procedure is using
<code>base64-decode</code>.
<p />The keyword argument specifies how to convert the decoded bytevector to string.
If this is #f, the procedure returns raw bytevector.
<p />The <code>base64url-decode-string</code> decodes Base64 URL safe encoded value.
</div>
<p /><div class="define"><span class="define-category">Function</span><a name="open-base64-decode-input-port2551">
    <span class="name" name="open-base64-decode-input-port">open-base64-decode-input-port</span>
  </a>
 <span class="args">source :key (owner? #f)</span></div>
<div class="define"><span class="define-category">Function</span><a name="open-base64-decode-output-port2552">
    <span class="name" name="open-base64-decode-output-port">open-base64-decode-output-port</span>
  </a>
 <span class="args">sink :key (owner? #f)</span></div>
<div class="define"><span class="define-category">Function</span><a name="open-base64url-decode-input-port2553">
    <span class="name" name="open-base64url-decode-input-port">open-base64url-decode-input-port</span>
  </a>
 <span class="args">source :key (owner? #f)</span></div>
<div class="define"><span class="define-category">Function</span><a name="open-base64url-decode-output-port2554">
    <span class="name" name="open-base64url-decode-output-port">open-base64url-decode-output-port</span>
  </a>
 <span class="args">sink :key (owner? #f)</span></div>
<div class="desc">Creates binary Base64 decode input and output port, respectively.
<p /><var>source</var> must be binary inpurt port.
<p />The input port reads Base64 encoded bytes from <var>source</var> and returns 
decoded results.
<p /><var>sink</var> must be binary inpurt port.
<p />The output port puts decoded bytes to <var>sink</var>. The port must be closed
to finish the encoding process properly.
<p />The <code>open-base64url-decode-input-port</code> and
<code>open-base64url-decode-output-port</code> decode Base64 URL safe encoded
value.
</div>
<p /></section><section class="subsubsection"><h4 class="subsubsection">
    <a class="section.anchor" name="G2555"><span class="section-number">7.33.3</span>Low level APIs</a>
  </h4>
<p />Both encode and decode procedures are using encoder and decoder. Both
encoder and decoder are just a procedure which takes 2 arguments
<var>get</var> and <var>put</var> and not reentrant as they have own internal
buffer to process the input.
<p /><div class="define"><span class="define-category">Function</span><a name="make-base64-encoder2556">
    <span class="name" name="make-base64-encoder">make-base64-encoder</span>
  </a>
 <span class="args">:key (encode-table *base64-encode-table*) (line-width 76) (padding? #t)</span></div>
<div class="desc">Creates a Base64 encoder. An encoder is a procedure which takes 2
arguments <var>get</var> and <var>put</var>.
<p /><var>get</var> must be a procedure takes 0 argument and it must return one
of the followings; a fixnum of range 0 to 255, EOF object, or negative
integer. The fixnum value is treated as an input of the encoding
value. The negative integer value is treated as a continue
marker. When the encoder receives this value, then it won't encode
until the next value is available.
<p /><var>put</var> must be a procedure takes 1 argument which is either a
fixnum of range 0 to 255 or <code>#f</code>. The fixnum is the encoded value
of the input. <code>#f</code> indicates line break point, so user can
determine which line break this encoder should use.
<p />The following shows how to make Base64 encoder with line break of CRLF.
<p /><pre class="codeblock">(define (base64-encode-w/crlf bv)
  (let-values (((out e) (open-bytevector-output-port)))
    (define (put v)
      (if v
	  (put-u8 out v)
	  (begin (put-u8 out #x0d) (put-u8 out #x0a))))
    (define inp (open-bytevector-input-port bv))
    (define (in) (get-u8 inp))
    (define encoder (make-base64-encoder))
    (do () ((encoder in put)))
    (e)))
</pre>
<p /></div>
<p /><div class="define"><span class="define-category">Function</span><a name="make-base64-decoder2557">
    <span class="name" name="make-base64-decoder">make-base64-decoder</span>
  </a>
 <span class="args">:key (decode-table *base64-decode-table*)</span></div>
<div class="desc">Creates a Base64 decoder. A decoder is a procedure which takes 2
arguments <var>get</var> and <var>put</var>.
<p /><var>get</var> is the same as the one from encoder.
<p /><var>put</var> must be a procedure takes 1 arguments which is a fixnm of
range 0 to 255. The value is always a decoded byte.
<p /></div>
<p /><div class="define">
    <span class="define-category">Constant</span>
    <a name="*base64-encode-table*2558">
      <span class="name" name="*base64-encode-table*">*base64-encode-table*</span>
    </a>
  </div>
<div class="define">
    <span class="define-category">Constant</span>
    <a name="*base64-decode-table*2559">
      <span class="name" name="*base64-decode-table*">*base64-decode-table*</span>
    </a>
  </div>
<div class="define">
    <span class="define-category">Constant</span>
    <a name="*base64-encode-url-table*2560">
      <span class="name" name="*base64-encode-url-table*">*base64-encode-url-table*</span>
    </a>
  </div>
<div class="define">
    <span class="define-category">Constant</span>
    <a name="*base64-decode-url-table*2561">
      <span class="name" name="*base64-decode-url-table*">*base64-decode-url-table*</span>
    </a>
  </div>
<div class="desc">Default encode or decode tables. If the name contains <code>url</code>, then it
is suitable for "base64url".
<p /></div>

</section></section>
  <div class="prev-next">
    <a class="prev" href="section732.html">(rfc :5322) - Internet message format library</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section734.html">(rfc cmac) - CMAC library</a>
  </div>
  <hr>
  <div id="document-footer">
    <div id="footer-message">This document was generated by<i>Takashi Kato</i> with Sagittarius gendoc. </div>
    <div id="footer-date">Generated date: <i>2021-09-10T21:24:49+0200</i></div>
  </div>
</html>