<!DOCTYPE html>
<html>
  <head>
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <div class="prev-next">
    <a class="prev" href="section727.html">(rfc base64) - Base 64 encode and decode library</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section729.html">(rfc hmac) - HMAC library</a>
  </div>
  <section class="subsection"><h3 class="subsection">
    <a class="section.anchor" name="rfc.cmac"><span class="section-number">7.28</span>(rfc cmac) - CMAC library</a>
  </h3>
<p />This section describes the CMAC extension of hash algorithm. The CMAC itself
is described <a href="http://tools.ietf.org/html/rfc4493">RFC 4493</a>.
The provided library make user be able to use the algorithm with the APIs of
math library's hash algorithm APIs. For the APIs detail, see
<a href="section717.html#math.hash">Hash operations</a>.
<p /><div class="define">
    <span class="define-category">Library</span>
    <a name="(rfc cmac)1945">
      <span class="name" name="(rfc cmac)">(rfc cmac)</span>
    </a>
  </div>
<div class="desc">Provides CMAC hash algorithm.</div>
<p /><div class="define">
    <span class="define-category">Variable</span>
    <a name="CMAC1946">
      <span class="name" name="CMAC">CMAC</span>
    </a>
  </div>
<div class="desc">The name for CMAC hash algorithm.
<p />The following example explains, how to use it.
<p /><pre class="codeblock">(import (rnrs) (rfc cmac) (math) (crypto))
<p />(define K (generate-secret-key AES (integer-&gt;bytevector 
				    #x2b7e151628aed2a6abf7158809cf4f3c)))
<p />(define aes-cipher (cipher AES K))
<p />(hash CMAC #vu8() :cipher aes-cipher)
;; =&gt; #vu8(187 29 105 41 233 89 55 40 127 163 125 18 155 117 103 70)
<p />;; for AES-CMAC-96
(hash CMAC #vu8() :cipher aes-cipher :size (/ 96 8))
;; =&gt; #vu8(187 29 105 41 233 89 55 40 127 163 125 18)
</pre>
<p />The RFC is defined for only AES block cipher however the implementation
can take any block cipher such as DES3.
<p />CAUTION: only AES cipher is tested.
</div>

</section>
  <div class="prev-next">
    <a class="prev" href="section727.html">(rfc base64) - Base 64 encode and decode library</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section729.html">(rfc hmac) - HMAC library</a>
  </div>
  <hr>
  <div id="document-footer">
    <div id="footer-message">This document was generated by<i>Takashi Kato</i> with Sagittarius gendoc. </div>
    <div id="footer-date">Generated date: <i>2015-05-15T10:11:33+0100</i></div>
  </div>
</html>