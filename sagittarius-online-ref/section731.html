<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <div class="prev-next">
    <a class="prev" href="section730.html">(util queue) - Queue</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section732.html">(rfc :5322) - Internet message format library</a>
  </div>
  <section class="subsection"><h3 class="subsection">
    <a class="section.anchor" name="record.builderr"><span class="section-number">7.31</span>(record builder) - Record builder</a>
  </h3>
<p /><div class="define">
    <span class="define-category">Library</span>
    <a name="(record builder)2515">
      <span class="name" name="(record builder)">(record builder)</span>
    </a>
  </div>
<div class="desc">Record builder library. This library provides utilities to
construct a record instance easily.
</div>
<p />The following example shows how to use the <code>make-record-builder</code>
macro.
<p /><div class="codeblock-box">
    <pre class="codeblock">(define-record-type base
  (fields a b c))
(define-syntax base-builder
  (make-record-builder base ((a 'a) (c 'c symbol-&gt;string))))

(base-builder)
</pre>
    <span class="codeblock-arrow">=&gt;</span>
    <span class="codeblock-result">#&lt;base a='a b=#f c="c"&gt;</span>
  </div>
<p /><div class="codeblock-box">
    <pre class="codeblock">(define-record-type child
  (parent base)
  (fields d e f))
(define-syntax child-builder
  (make-record-builder child ((a 'b))))

(child-builder)
</pre>
    <span class="codeblock-arrow">=&gt;</span>
    <span class="codeblock-result">#&lt;child a='b b=#f c=#f d=#f e=#f f=#f&gt;</span>
  </div>
<p /><div class="define"><span class="define-category">Macro</span><a name="make-record-builder2516">
    <span class="name" name="make-record-builder">make-record-builder</span>
  </a> <span class="args">rtd (default ...)</span></div>
<div class="desc">Make a record builder macro transformer.
<p /><var>Default</var> must be one of the following form:
<p /><pre class="snipet">(<var>field-name</var> <var>value</var>)</pre>
<pre class="snipet">(<var>field-name</var> <var>value</var> <var>converter</var>)</pre>
<p /><var>field-name</var> must be a field name of the <var>rtd</var>. <var>value</var> is a
default in case the builder didn't receive the field. The <var>converter</var>
of the second form must be a procedure which accepts one argument. The
result of this procedure will be used to instantisate the record. It
will also apply the <var>value</var>.
<p />
The result of the macro transformer accepts the following forms:
<p /><pre class="snipet">(<var>field-name</var> <var>value</var>) ...</pre>
<pre class="snipet">(<code>from</code> <var>record-instance</var>) (<var>field</var> <var>value</var>) ...</pre>
<p />The <code>from</code> is an auxiliary macro bound in the <code>(record builder)</code>.
The value of <code>from</code>, <var>record-instance</var>, will be copied to the
creating record.
</div>

</section>
  <div class="prev-next">
    <a class="prev" href="section730.html">(util queue) - Queue</a>
    <a class="top" href="../sagittarius-online-ref.html">Top</a>
    <a class="next" href="section732.html">(rfc :5322) - Internet message format library</a>
  </div>
  <hr>
  <div id="document-footer">
    <div id="footer-message">This document was generated by<i>Takashi Kato</i> with Sagittarius gendoc. </div>
    <div id="footer-date">Generated date: <i>2021-09-10T21:24:49+0200</i></div>
  </div>
</html>