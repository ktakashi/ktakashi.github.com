<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <body>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section733.html">(rfc base64) - Base 64 encode and decode library</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section735.html">(rfc hmac) - HMAC library</a>
    </p>
    <section node-type="section">
      <h2 node-type="header-2">
        <a name="rfc.cmac">(rfc cmac) - CMAC library</a>
      </h2>
      <p node-type="paragraph">This section describes the CMAC extension of hash algorithm. The CMAC itself
is described <a href="http://tools.ietf.org/html/rfc4493">RFC 4493</a>.
The provided library make user be able to use the algorithm with the APIs of
math library's hash algorithm APIs. For the APIs detail, see
<a href="section719.html#math.hash">Hash operations</a>.</p>
      <div node-type="define" class="define">
        <span>Library</span>
        <a name="(rfc cmac)_33">
          <span>(rfc cmac)</span>
        </a>
      </div>
      <p node-type="paragraph">Provides CMAC hash algorithm.</p>
      <div node-type="define" class="define">
        <span>Variable</span>
        <a name="CMAC_112">
          <span>CMAC</span>
        </a>
      </div>
      <p node-type="paragraph">The name for CMAC hash algorithm.</p>
      <p node-type="paragraph">The following example explains, how to use it.</p>
      <pre lang="scheme" node-type="block"><code>(import (rnrs) (rfc cmac) (math) (crypto))

(define K (generate-secret-key AES (integer-&gt;bytevector 
				    #x2b7e151628aed2a6abf7158809cf4f3c)))

(define aes-cipher (cipher AES K))

(hash CMAC #vu8() :cipher aes-cipher)
;; =&gt; #vu8(187 29 105 41 233 89 55 40 127 163 125 18 155 117 103 70)

;; for AES-CMAC-96
(hash CMAC #vu8() :cipher aes-cipher :size (/ 96 8))
;; =&gt; #vu8(187 29 105 41 233 89 55 40 127 163 125 18)
</code></pre>
      <p node-type="paragraph">The RFC is defined for only AES block cipher however the implementation
can take any block cipher such as DES3.</p>
      <p node-type="paragraph">CAUTION: only AES cipher is tested.</p>
    </section>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section733.html">(rfc base64) - Base 64 encode and decode library</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section735.html">(rfc hmac) - HMAC library</a>
    </p>
    <div node-type="section">
      <hr>
      <p node-type="paragraph" class="author footer">This document was generated by <i node-type="i">Takashi Kato</i> with Sagittarius gendoc.<br>Generated date: <i node-type="i">2023-06-18T11:03:41+0200</i></p>
    </div>
  </body>
</html>