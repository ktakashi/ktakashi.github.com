<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <body>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section25.html">Compiled cache</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section3.html">R6RS Libraries</a>
    </p>
    <section node-type="section">
      <h2 node-type="header-2">
        <a name="Deviation">Deviation</a>
      </h2>
      <p node-type="paragraph">Some of the behaviours are not compliant or deviate from other implementations.
Here, we list some of them.</p>
      <section node-type="section">
        <h3 node-type="header-3">
          <a name="Macro-expansion">Macro expansion</a>
        </h3>
        <p node-type="paragraph">The following code will print <code node-type="code">#t</code> instead of <code node-type="code">#f</code> with <code node-type="code">-r6</code>command line option or doing it on a library:</p>
        <pre lang="scheme" node-type="block"><code>(import (rnrs) (for (rnrs eval) expand))

(define-syntax foo
  (lambda(ctx)
    (syntax-case ctx ()
      ((_ id)
       (free-identifier=?
	#'id
	(eval '(datum-&gt;syntax #'k 'bar) (environment '(rnrs))))))))

(define bar)

(display (foo bar))
</code></pre>
        <p node-type="paragraph">This is because, Sagittarius doesn't have separated phases of macro expansion
and compilation. When <code node-type="code">foo</code> is expanded, then the <code node-type="code">bar</code> is not defined
yet or at least it's not visible during the macro expansion. So, both _bar_s
are not bound, then <code node-type="code">free-identifier=?</code> will consider them the same
identifiers.</p>
      </section>
      <section node-type="section">
        <h3 node-type="header-3">
          <a name="Directives">Directives</a>
        </h3>
        <p node-type="paragraph">On R6RS, symbol starts with <code node-type="code">#!</code> is ignored, however this is not the case
on R7RS. Sagittarius ignores these symbols on both mode.</p>
      </section>
    </section>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section25.html">Compiled cache</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section3.html">R6RS Libraries</a>
    </p>
    <div node-type="section">
      <hr>
      <p node-type="paragraph" class="author footer">This document was generated by <i node-type="i">Takashi Kato</i> with Sagittarius gendoc.<br>Generated date: <i node-type="i">2024-09-09T21:26:28+0200</i></p>
    </div>
  </body>
</html>