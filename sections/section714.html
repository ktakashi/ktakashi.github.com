<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <body>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section713.html">(util file) - File operation utility library</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section715.html">(util hashtables) - Hashtable utilities</a>
    </p>
    <section node-type="section">
      <h2 node-type="header-2">
        <a name="getopt">(getopt) - Parsing command-line options</a>
      </h2>
      <div node-type="define" class="define">
        <span>Library</span>
        <a name="(getopt)_11">
          <span>(getopt)</span>
        </a>
      </div>
      <p node-type="paragraph">This library defines a convenient way to parse command-line options.</p>
      <p node-type="paragraph">The library exports a thin wrapper of <a href="sections/section9.html#srfi">SRFI-37: args-fold</a>.</p>
      <div node-type="define" class="define">
        <span>Macro</span>
        <a name="with-args_48">
          <span>with-args</span>
          <span>
            <i node-type="i">args</i>
          </span>
          <span>
            <i node-type="i">(bind-spec</i>
          </span>
          <span>
            <i node-type="i">...</i>
          </span>
          <span>
            <i node-type="i">[.</i>
          </span>
          <span>
            <i node-type="i">rest])</i>
          </span>
          <span>
            <i node-type="i">body</i>
          </span>
          <span>
            <i node-type="i">...</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">This macro wraps <code node-type="code">args-fold</code> provided by SRFI-37. It takes a list
of arguments, <i node-type="i">args</i>, and scans it to find Unix-style command-line
options and binds their values to local variables according to <i node-type="i">bind-spec</i>,
then executes <i node-type="i">body</i>.</p>
      <p node-type="paragraph">Following is the example how to use;</p>
      <pre lang="scheme" node-type="block"><code>(define (usage args) ...)

(define (main args)
  (with-args args
     ((verbose (#\v "verbose") #f #f)
      (file    (#\f "file") #t (usage args))
      (debug-level   (#\d "debug-level") #t "0")
      . rest)
    ...))
</code></pre>
      <p node-type="paragraph">The <i node-type="i">bind-spec</i> must be one of the following forms;</p>
      <ul node-type="bullet-list">
        <li>
          <p node-type="paragraph">
            <i node-type="i">(var (short long) value-required? default)</i>
          </p>
        </li>
        <li>
          <p node-type="paragraph">
            <i node-type="i">(var (short long) <code node-type="code">*</code> default)</i>
          </p>
        </li>
      </ul>
      <p node-type="paragraph"><i node-type="i">var</i> is variable name. <i node-type="i">short</i> must be a character represents the
short argument name. <i node-type="i">long</i> must be a string represents the long argument
name. <i node-type="i">value-required?</i> specifies whether or not the optional argument
has the value. <i node-type="i">default</i> is the default form of the variable so it will
be evaluated when the input <i node-type="i">args</i> didn't have the specified option.</p>
      <p node-type="paragraph">If the second form is used, the <code node-type="code">*</code> is syntactic keyword and the
passed value will be packed to list. Thus the script can take more than one
the same options.</p>
      <p node-type="paragraph">If <i node-type="i">rest</i> is not presented and <i node-type="i">args</i> contains non listed argument,
then it raises an <code node-type="code">&amp;assertion</code>. If it is, then it will pack the rest of
non listed argument as a list.</p>
    </section>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section713.html">(util file) - File operation utility library</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section715.html">(util hashtables) - Hashtable utilities</a>
    </p>
    <div node-type="section">
      <hr>
      <p node-type="paragraph" class="author footer">This document was generated by <i node-type="i">Takashi Kato</i> with Sagittarius gendoc.<br>Generated date: <i node-type="i">2023-06-18T11:03:41+0200</i></p>
    </div>
  </body>
</html>