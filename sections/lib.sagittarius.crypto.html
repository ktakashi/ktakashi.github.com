<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <body>
    <p node-type="paragraph" class="navigation-container">
      <a href="./lib.sagittarius.generators.html">(sagittarius generators) - Generators</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./lib.sagittarius.atomic.html">(sagittarius atomic) - Atomic operation</a>
    </p>
    <section node-type="section">
      <h2 node-type="header-2">
        <a name="lib.sagittarius.crypto">Cryptographic libraries</a>
      </h2>
      <p node-type="paragraph">Sagittarius provides a comprehensive set of cryptographic libraries.
Currently the libraries support below:</p>
      <ul node-type="bullet-list">
        <li>
          <p node-type="paragraph">Block cipher</p>
        </li>
        <li>
          <p node-type="paragraph">Asymmetric cipher</p>
        </li>
        <li>
          <p node-type="paragraph">Cryptographic hash functions</p>
        </li>
        <li>
          <p node-type="paragraph">Cryptographically secure pseudo random number generators (CSPRNG)</p>
        </li>
        <li>
          <p node-type="paragraph">Signature generation / verification</p>
        </li>
        <li>
          <p node-type="paragraph">Key generate, agreement and import/export</p>
        </li>
        <li>
          <p node-type="paragraph">MAC</p>
        </li>
        <li>
          <p node-type="paragraph">X.509 CSR, CRL and certificate</p>
        </li>
        <li>
          <p node-type="paragraph">PKCS#5 via PBKDF</p>
        </li>
        <li>
          <p node-type="paragraph">PKCS#8</p>
        </li>
        <li>
          <p node-type="paragraph">PKCS#12 keystore</p>
        </li>
        <li>
          <p node-type="paragraph">PEM</p>
        </li>
        <li>
          <p node-type="paragraph">Various KDFs</p>
        </li>
      </ul>
      <p node-type="paragraph">Not like legacy <code node-type="code">(crypto)</code> and <code node-type="code">(math)</code> libraries, these libraries are
split per components. Users need to combine some libraries to achieve
their goals.</p>
      <h3 node-type="header-3">
        <a name="Examples">Examples</a>
      </h3>
      <p node-type="paragraph">This section shows some basic examples how to use the crypto graphic
libraries.</p>
      <h4 node-type="header-4">
        <a name="Block-cipher">Block cipher</a>
      </h4>
      <p node-type="paragraph">This example encrypts and decrypts a plain text with a radomly generated
secret key. The encryption scheme is AES-256 and encryption mode is CTR.</p>
      <details node-type="expansion" source="../../example/crypto/aes-ctr.scm">
        <summary>AES-256 CTR</summary>
        <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto ciphers)
        (sagittarius crypto keys))

;; Randomly generates AES-256 secret key.
(define key (generate-symmetric-key *scheme:aes-256*))

;; Initial Vector (use randomly generated one in production code)
(define iv
 (make-bytevector (block-cipher-descriptor-block-length *scheme:aes-256*) 1))

;; AES-256 cipher with CTR mode, without padding 
(define aes-cipher 
 (make-block-cipher *scheme:aes-256* *mode:ctr* no-padding))

;; Cipher parameter.
;; NOTE, IV will be copied so modifying original IV doesn't affect the result
(define parameter
  (make-cipher-parameter
   (make-iv-parameter iv)
   (make-counter-mode-parameter *ctr-mode:big-endian*)))

(define (encrypt cipher key parameter plain-text)
  (block-cipher-init! cipher (cipher-direction encrypt) key parameter)
  (let ((cipher-text (block-cipher-encrypt-last-block cipher plain-text)))
    (block-cipher-done! cipher)
    cipher-text))

(define (decrypt cipher key parameter cipher-text)
  (block-cipher-init! cipher (cipher-direction decrypt) key parameter)
  (let ((plain-text (block-cipher-decrypt-last-block cipher cipher-text)))
    (block-cipher-done! cipher)
    plain-text))

(define plain-text (string-&gt;utf8 "Hello Sagittarius Scheme!"))
(decrypt aes-cipher key parameter (encrypt aes-cipher key parameter plain-text))
;; -&gt; A bytevector of UTF-8 representation of `plain-text`
</code></pre>
      </details>
      <p node-type="paragraph">This example shows how to use a string password as a key
(Password-Based Encryption Scheme, a.k.a. PBES). PBES is just a block cipher
using a derived key. To do so, you need to use KDF, Key Derivation Function.</p>
      <details node-type="expansion" source="../../example/crypto/pbes.scm">
        <summary>PBES</summary>
        <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto ciphers)
        (sagittarius crypto keys)
        (sagittarius crypto kdfs)    ;; for PBKDF2
        (sagittarius crypto digests) ;; for digests, e.g. SHA-256
        (sagittarius crypto mac))    ;; for MAC, NOTE: PRF = MAC

;; If everyone uses this kind of password, then it'd be almost impossibe
;; to crack :)
(define password "You can't guess this password! It's so strong!! :D")

;; PRF
(define prf (mac-&gt;prf-provider *mac:hmac* :digest *digest:sha-256*))

(define (derive-key scheme password)
  ;; I'm not sure if this is a bad practice or not, but for simplicity
  ;; we use hashed password as a salt
  (define md (make-message-digest *digest:sha-256*))
  (define bv (string-&gt;utf8 password))
  (define salt (digest-message md bv))
  ;; 310,000 iteration, required by FIPS-140
  (pbkdf-2 bv salt 310000
    (block-cipher-descriptor-suggested-key-length scheme)
        :prf prf))

(define key 
 (generate-symmetric-key *scheme:aes-256*
  (derive-key *scheme:aes-256* password)))

;; The rest can be the same as above CTR mode example.
</code></pre>
      </details>
      <p node-type="paragraph">This example shows how to handle <code node-type="code">offline</code> encryption mode.</p>
      <details node-type="expansion" source="../../example/crypto/aes-siv.scm">
        <summary>AES-SIV</summary>
        <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto ciphers)
        (sagittarius crypto keys))

(define key (generate-symmetric-key *scheme:aes-256*))
;; GCM-SIV nonce size = 12
(define iv (make-bytevector 12))

;; AES-256-GCM-SIV 
(define aes-cipher
  (make-block-cipher *scheme:aes-256* *mode:gcm-siv* no-padding))

(define parameter
  (make-cipher-parameter
   (make-iv-parameter iv)
   ;; empyt AAD :)
   (make-aad-parameter #vu8())))

(define (encrypt-messages . messages)
  (for-each (lambda (message)
              ;; output space is not needed, and this procedure returns 0
              (block-cipher-encrypt! aes-cipher message 0 #vu8() 0)) messages)
  (let* ((out-size (block-cipher-last-block-size aes-cipher 0))
         (out (make-bytevector out-size)))
    ;; passing dummy block
    (block-cipher-encrypt-last-block! aes-cipher #vu8() 0 out 0)
    (values out (block-cipher-done/tag aes-cipher))))

(block-cipher-init! aes-cipher (cipher-direction encrypt) key parameter)
(let-values (((enc tag) (encrypt-messages (string-&gt;utf8 "Hello, GCM-SIV") (string-&gt;utf8 "\nI'm done"))))
  (block-cipher-init! aes-cipher (cipher-direction decrypt) key (make-cipher-parameter parameter (make-tag-parameter tag)))
  (let* ((size (block-cipher-last-block-size aes-cipher enc))
         (msg (make-bytevector size)))
    (block-cipher-decrypt-last-block! aes-cipher enc 0 msg 0)
    (block-cipher-done/tag! aes-cipher tag)
    (utf8-&gt;string msg)))
;; "Hello, GCM-SIV\nI'm done"
</code></pre>
      </details>
      <h4 node-type="header-4">
        <a name="Stream-cipher">Stream cipher</a>
      </h4>
      <p node-type="paragraph">This example encrypts and decrypts a plain text with a randomly generated
secret key. The encryption scheme is ChaCha20 Poly1305.</p>
      <details node-type="expansion" source="../../example/crypto/chacha20-poly1305.scm">
        <summary>ChaCha20 Poly1305</summary>
        <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto ciphers)
        (sagittarius crypto random)
        (sagittarius crypto keys))

;; Randomly generates secret key.
(define key (generate-symmetric-key *scheme:chacha20*))

;; secure random generator
(define prng (secure-random-generator *prng:chacha20*))

(define cipher (make-stream-cipher *scheme:chacha20-poly1305*))
;; 96 bits nonce
(define nonce (make-iv-parameter (random-generator-read-random-bytes prng 12)))

;; init cipher for encryption
(stream-cipher-init! cipher (cipher-direction encrypt) key nonce)
(define plain-text (string-&gt;utf8 "Hello ChaCha20-Poly1305"))

(define cipher-text (stream-cipher-encrypt cipher plain-text))
;; 128 bits tag length
(define tag (stream-cipher-done/tag cipher 16))

;; reinitialize cipher for decryption
(stream-cipher-init! cipher (cipher-direction decrypt) key nonce)

(let ((pt (stream-cipher-decrypt cipher cipher-text)))
  ;; make sure you verify the tag
  (stream-cipher-done/tag! cipher tag)
  ;; the plain text
  (utf8-&gt;string pt))
</code></pre>
      </details>
      <h4 node-type="header-4">
        <a name="Asymmetric-cipher">Asymmetric cipher</a>
      </h4>
      <p node-type="paragraph">This example encrypts and decrypts a plain text with a randomly generated
RSA key pair.</p>
      <details node-type="expansion" source="../../example/crypto/rsa-cipher.scm">
        <summary>RSA Cipher</summary>
        <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto ciphers)
        (sagittarius crypto keys)
        (sagittarius crypto digests))

;; Randomly genrates RSA key pair. Default 2048 bits
(define key-pair (generate-key-pair *key:rsa*))

;; Making RSA cipher with OAEP encoding (default) with SHA-256
(define rsa-cipher
 (make-asymmetric-cipher *scheme:rsa* :digest *digest:sha-256*))

;; Encryption can only be done by a public key
(define (encrypt cipher key plain-text)
  (asymmetric-cipher-init! cipher key)
  (let ((cipher-text (asymmetric-cipher-encrypt-bytevector cipher plain-text)))
    (asymmetric-cipher-done! cipher)
    cipher-text))

;; Decryption can only be done by a private key
(define (decrypt cipher key cipher-text)
  (asymmetric-cipher-init! cipher key)
  (let ((plain-text (asymmetric-cipher-decrypt-bytevector cipher cipher-text)))
    (asymmetric-cipher-done! cipher)
    plain-text))

(define message (string-&gt;utf8 "Hello Sagittarius Scheme"))
(decrypt rsa-cipher (key-pair-private key-pair)
  (encrypt rsa-cipher (key-pair-public key-pair) message))
;; -&gt; A bytevector of UTF-8 representation of `plain-text`
</code></pre>
      </details>
      <h4 node-type="header-4">
        <a name="Cryptographic-hash-function">Cryptographic hash function</a>
      </h4>
      <p node-type="paragraph">In the libraries, hash is called digest. So, from now on we use digest instead
of hash.</p>
      <p node-type="paragraph">Below example shows how to generate a digest of SHA-256.</p>
      <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto digests))

(define md (make-message-digest *digest:sha-256*))

(digest-message md (string-&gt;utf8 "Hello Sagittarius Scheme"))
;; -&gt; #vu8(65 109 154 253 119 192 195 187 255 90 75 208 135 51 25 43 106 121 236 172 96 233 38 189 154 240 32 8 116 58 169 237)
</code></pre>
      <p node-type="paragraph">Also below example shows how to generate a digest of SHAKE-256, which
generates a variable length digest.</p>
      <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto digests))

(define md (make-message-digest *digest:shake-256*))

;; Generates 32 bytes digests
(digest-message md (string-&gt;utf8 "Hello Sagittarius Scheme") 32)
;; -&gt; #vu8(127 141 98 85 40 216 103 129 10 71 136 179 158 103 163 218 109 65 244 77 119 4 109 54 135 126 225 162 188 58 16 64)
</code></pre>
      <h4 node-type="header-4">
        <a name="Cryptographically-secure-pseudo-random-number-generators-CSPRNG">Cryptographically secure pseudo random number generators (CSPRNG)</a>
      </h4>
      <p node-type="paragraph">Below example shows how to generate a random integer.</p>
      <pre lang="scheme" node-type="block"><code>(import (rnrs)
        (sagittarius crypto random))

;; Pseudo random generator, it returns the same value each execution
(define prng (pseudo-random-generator *prng:chacha20*))
;; Secure random generator, it returns random value each execution
;; (define prng (secure-random-generator *prng:chacha20*))

;; range of 0 &lt;= r &lt; 100
(random-generator-random-integer prng 100)
;; -&gt; each time the same result as it's pseudo random, not secure random
</code></pre>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.keys">Key library - (sagittarius crypto keys)</a>
        </h2>
        <p node-type="paragraph">The key library provides key operations for both symmetric and asymmetric
keys.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto keys)_92">
            <span>(sagittarius crypto keys)</span>
          </a>
        </div>
        <p node-type="paragraph">The key library, this library exports the procedures listed below sections.</p>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Key-type">Key type</a>
          </h3>
          <p node-type="paragraph">Sagittarius crypto library uses hierachial key structure. The hierarchy of
the key type is below.</p>
          <pre lang="" node-type="block"><code>                 +--------------+
                 | &lt;crypto-key&gt; |
                 +------+-------+
                        |
         +--------------+-------------+
         |                            |
+--------+--------+          +--------+---------+
| &lt;symmetric-key&gt; |          | &lt;asymmetric-key&gt; |
+-----------------+          +--------+---------+
                                      |
                             +--------+--------+
                             |                 |
                     +-------+------+  +-------+------+
                     | &lt;public-key&gt; |  | &lt;private-key |
                     +--------------+  +--------------+
</code></pre>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="crypto-key?_176">
              <span>crypto-key?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is an instance of <code node-type="code">&lt;crypto-key&gt;</code>,
otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="symmetric-key?_369">
              <span>symmetric-key?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is an instance of <code node-type="code">&lt;symmetric-key&gt;</code>,
otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-key?_72">
              <span>asymmetric-key?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is an instance of <code node-type="code">&lt;asymmetric-key&gt;</code>,
otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="public-key?_181">
              <span>public-key?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is an instance of <code node-type="code">&lt;public-key&gt;</code>,
otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="private-key?_148">
              <span>private-key?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is an instance of <code node-type="code">&lt;private-key&gt;</code>,
otherwise <code node-type="code">#f</code>.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Symmetric-key-operations">Symmetric key operations</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-symmetric-key_306">
              <span>make-symmetric-key</span>
              <span> (</span>
              <span>
                <i node-type="i">bv</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a symmetric key of the value of <i node-type="i">bv</i>.<br>The key can be used for any of the symmetric ciphers supported by
Sagittarius, however it is users' responsibility to align the key
size. If you want to make sure the <i node-type="i">bv</i> has the right key size,
consier using <code node-type="code">generate-symmetric-key</code> method.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="symmetric-key-value_368">
              <span>symmetric-key-value</span>
              <span> (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the raw key value of the given <i node-type="i">key</i>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="generate-symmetric-key_27">
              <span>generate-symmetric-key</span>
              <span>
                <code node-type="code">&lt;block-cipher-descriptor&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="generate-symmetric-key_26">
              <span>generate-symmetric-key</span>
              <span>
                <code node-type="code">&lt;block-cipher-descriptor&gt;</code>
              </span>
              <span>
                <code node-type="code">&lt;random-generator&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Generates a symmetric key suitable for the given block cipher scheme,
randomly.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="generate-symmetric-key_25">
              <span>generate-symmetric-key</span>
              <span>
                <code node-type="code">&lt;block-cipher-descriptor&gt;</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a symmetric from the bytevector, this method checks the
key size if it's appropriate for the given cipher or not.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-rfc3394-key-wrap_260">
              <span>make-rfc3394-key-wrap</span>
              <span> (</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <code node-type="code">block-cipher-descriptor?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) :key </span>
              <span>
                <i node-type="i">iv</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a key wrap procedure using given <i node-type="i">scheme</i> and <i node-type="i">key</i>. The optional
keyword parameter <i node-type="i">iv</i> is used as an initial vector if provided.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-aes-key-wrap_22">
              <span>make-aes-key-wrap</span>
              <span> (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates an AES key wrap procedure.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-camellia-key-wrap_61">
              <span>make-camellia-key-wrap</span>
              <span> (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates an Camellia key wrap procedure.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-rfc3394-key-unwrap_259">
              <span>make-rfc3394-key-unwrap</span>
              <span> (</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <code node-type="code">block-cipher-descriptor?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) :key </span>
              <span>
                <i node-type="i">iv</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a key unwrap procedure using given <i node-type="i">scheme</i> and <i node-type="i">key</i>. The optional
keyword parameter <i node-type="i">iv</i> is used as an initial vector if provided.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-aes-key-unwrap_20">
              <span>make-aes-key-unwrap</span>
              <span> (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates an AES key unwrap procedure.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-camellia-key-unwrap_60">
              <span>make-camellia-key-unwrap</span>
              <span> (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates an Camellia key unwrap procedure.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Asymmetric-key-operations">Asymmetric key operations</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="key-pair?_8">
              <span>key-pair?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a key pair, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="key-pair-private_6">
              <span>key-pair-private</span>
              <span> (</span>
              <span>
                <i node-type="i">kp</i>
              </span>
              <span>
                <code node-type="code">key-pair?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the private key of the given <i node-type="i">kp</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="key-pair-public_7">
              <span>key-pair-public</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the public key of the given <i node-type="i">kp</i>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="generate-key-pair_13">
              <span>generate-key-pair</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Generates a key pair of the given <i node-type="i">scheme</i>. Followings are the supported
schemes:</p>
          <div node-type="define" class="define">
            <span>Key scheme</span>
            <a name="*key:rsa_140">
              <span>*key:rsa</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Key scheme</span>
            <a name="*key:dsa_136">
              <span>*key:dsa</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Key scheme</span>
            <a name="*key:ecdsa_137">
              <span>*key:ecdsa</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Key scheme</span>
            <a name="*key:ed25519_138">
              <span>*key:ed25519</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Key scheme</span>
            <a name="*key:ed448_139">
              <span>*key:ed448</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Key scheme</span>
            <a name="*key:x25519_141">
              <span>*key:x25519</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Key scheme</span>
            <a name="*key:x448_142">
              <span>*key:x448</span>
            </a>
          </div>
          <p node-type="paragraph">Those are RSA, DSA, ECDSA, Ed5519, Ed448, X25519 and X448 respectively.<br>For convenience <code node-type="code">*scheme:rsa</code> has the same effect as <code node-type="code">*key:rsa</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="generate-public-key_22">
              <span>generate-public-key</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span> ...</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="generate-private-key_20">
              <span>generate-private-key</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span> ...</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Macro</span>
            <a name="public-key-format_178">
              <span>public-key-format</span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">A macro returns a symbol representation of <i node-type="i">format</i>. The <i node-type="i">format</i> must be
either <code node-type="code">raw</code> or <code node-type="code">subject-public-key-info</code>.</p>
          <p node-type="paragraph"><code node-type="code">raw</code>:
Imports/exports raw public key.
<code node-type="code">subject-public-key-info</code>:
Imports/exports subject public key info.</p>
          <div node-type="define" class="define">
            <span>Enum set</span>
            <a name="*public-key-formats*_189">
              <span>*public-key-formats*</span>
            </a>
          </div>
          <p node-type="paragraph">Enum set of the <code node-type="code">public-key-format</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="public-key-format?_179">
              <span>public-key-format?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a member of <code node-type="code">public-key-format</code> enum.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_52">
              <span>import-public-key</span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span>
                <code node-type="code">'subject-public-key-info</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_51">
              <span>import-public-key</span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span>
                <code node-type="code">'subject-public-key-info</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports a public from the given <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code> which must be
a valid subject public key info.<br>The returning public key type is detected via the OID inside of the
subject public key info.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_50">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:rsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_49">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:rsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports RSA key from given <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>. The optional <i node-type="i">format</i>
specifies the format of the given key. Default value is <code node-type="code">raw</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_81">
              <span>export-public-key</span>
              <span>
                <code node-type="code">&lt;rsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_80">
              <span>export-public-key</span>
              <span>
                <code node-type="code">*key:rsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;rsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports RSA key from the given <code node-type="code">&lt;rsa-public-key&gt;</code>. The optional <i node-type="i">format</i>
controls the format of the exporting key. Default value is <code node-type="code">raw</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_48">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:dsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
              <span>
                <i node-type="i">parameter</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_47">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:dsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
              <span>
                <i node-type="i">parameter</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports DSA key from given <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>. The optional
<i node-type="i">format</i> specifies the format of the given key. Default value is
<code node-type="code">subject-public-key-info</code>.</p>
          <p node-type="paragraph">If <code node-type="code">raw</code> is specified, then optional argument <i node-type="i">parameter</i> must be specified
and it must be <code node-type="code">&lt;dsa-key-parameter&gt;</code></p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_79">
              <span>export-public-key</span>
              <span>
                <code node-type="code">&lt;dsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_78">
              <span>export-public-key</span>
              <span>
                <code node-type="code">*key:dsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;dsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports DSA key from the given <code node-type="code">&lt;dsa-public-key&gt;</code>. The optional
<i node-type="i">format</i> controls the format of the exporting key. Default value
is <code node-type="code">subject-public-key-info</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_46">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:ecdsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
              <span>
                <i node-type="i">ec-parameter</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_45">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:ecdsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
              <span>
                <i node-type="i">ec-parameter</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports ECDSA key from given <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>. The optional
<i node-type="i">format</i> specifies the format of the given key. Default value is
<code node-type="code">subject-public-key-info</code>.<br>If <code node-type="code">raw</code> format is specified, then optional parameter <code node-type="code">ec-parameter</code> must be
specified. Below are the supported EC parameters.</p>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:p192*_73">
              <span>*ec-parameter:p192*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:p224*_74">
              <span>*ec-parameter:p224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:p256*_75">
              <span>*ec-parameter:p256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:p384*_76">
              <span>*ec-parameter:p384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:p521*_77">
              <span>*ec-parameter:p521*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:k163*_68">
              <span>*ec-parameter:k163*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:k233*_69">
              <span>*ec-parameter:k233*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:k283*_70">
              <span>*ec-parameter:k283*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:k409*_71">
              <span>*ec-parameter:k409*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:k571*_72">
              <span>*ec-parameter:k571*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:b163*_49">
              <span>*ec-parameter:b163*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:b233*_50">
              <span>*ec-parameter:b233*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:b283*_51">
              <span>*ec-parameter:b283*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:b409*_52">
              <span>*ec-parameter:b409*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:b571*_53">
              <span>*ec-parameter:b571*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp160r1*_79">
              <span>*ec-parameter:secp160r1*</span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp160k1*_78">
              <span>*ec-parameter:secp160k1*</span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp160r2*_80">
              <span>*ec-parameter:secp160r2*</span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp192r1*_82">
              <span>*ec-parameter:secp192r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp224r1*_84">
              <span>*ec-parameter:secp224r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp256r1*_86">
              <span>*ec-parameter:secp256r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp384r1*_87">
              <span>*ec-parameter:secp384r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp521r1*_88">
              <span>*ec-parameter:secp521r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect163k1*_90">
              <span>*ec-parameter:sect163k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect233k1*_93">
              <span>*ec-parameter:sect233k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect283k1*_96">
              <span>*ec-parameter:sect283k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect409k1*_98">
              <span>*ec-parameter:sect409k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect571k1*_100">
              <span>*ec-parameter:sect571k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect163r2*_92">
              <span>*ec-parameter:sect163r2*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect233r1*_94">
              <span>*ec-parameter:sect233r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect283r1*_97">
              <span>*ec-parameter:sect283r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect409r1*_99">
              <span>*ec-parameter:sect409r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect571r1*_101">
              <span>*ec-parameter:sect571r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp192k1*_81">
              <span>*ec-parameter:secp192k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp224k1*_83">
              <span>*ec-parameter:secp224k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:secp256k1*_85">
              <span>*ec-parameter:secp256k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect163r1*_91">
              <span>*ec-parameter:sect163r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect239k1*_95">
              <span>*ec-parameter:sect239k1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:sect113r1*_89">
              <span>*ec-parameter:sect113r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p160r1*_54">
              <span>*ec-parameter:brainpool-p160r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p160t1*_55">
              <span>*ec-parameter:brainpool-p160t1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p192r1*_56">
              <span>*ec-parameter:brainpool-p192r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p192t1*_57">
              <span>*ec-parameter:brainpool-p192t1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p224r1*_58">
              <span>*ec-parameter:brainpool-p224r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p224t1*_59">
              <span>*ec-parameter:brainpool-p224t1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p256r1*_60">
              <span>*ec-parameter:brainpool-p256r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p256t1*_61">
              <span>*ec-parameter:brainpool-p256t1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p320r1*_62">
              <span>*ec-parameter:brainpool-p320r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p320t1*_63">
              <span>*ec-parameter:brainpool-p320t1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p384r1*_64">
              <span>*ec-parameter:brainpool-p384r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p384t1*_65">
              <span>*ec-parameter:brainpool-p384t1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p512r1*_66">
              <span>*ec-parameter:brainpool-p512r1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>EC parameter</span>
            <a name="*ec-parameter:brainpool-p512t1*_67">
              <span>*ec-parameter:brainpool-p512t1*</span>
            </a>
          </div>
          <p node-type="paragraph">After <code node-type="code">ec-parameter:</code> represents the parameter name.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_77">
              <span>export-public-key</span>
              <span>
                <code node-type="code">&lt;ecdsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_76">
              <span>export-public-key</span>
              <span>
                <code node-type="code">*key:ecdsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;ecdsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports ECDSA key from the given <code node-type="code">&lt;ecdsa-public-key&gt;</code>. The optional
<i node-type="i">format</i> controls the format of the exporting key. Default value
is <code node-type="code">subject-public-key-info</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_44">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:ed25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_43">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:ed25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_42">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:ed448*</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_41">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:ed448*</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports Ed25519 or Ed448 public key from the given <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>.
The optional <i node-type="i">format</i> controls the key format, default is <code node-type="code">raw</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_75">
              <span>export-public-key</span>
              <span>
                <code node-type="code">&lt;eddsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_74">
              <span>export-public-key</span>
              <span>
                <code node-type="code">*key:ed25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;eddsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_73">
              <span>export-public-key</span>
              <span>
                <code node-type="code">&lt;eddsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_72">
              <span>export-public-key</span>
              <span>
                <code node-type="code">*key:ed448*</code>
              </span>
              <span>
                <code node-type="code">&lt;eddsa-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports Ed25519 or Ed448 key from the given <code node-type="code">&lt;eddsa-public-key&gt;</code>. The optional
<i node-type="i">format</i> controls the format of the exporting key. Default value
is <code node-type="code">raw</code>.</p>
          <p node-type="paragraph">If the first form is used, then the method automatically detects the key type.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_40">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:x25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_39">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:x25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_38">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:x448*</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-public-key_37">
              <span>import-public-key</span>
              <span>
                <code node-type="code">*key:x448*</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports X25519 or X448 public key from the given <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>.
The optional <i node-type="i">format</i> controls the key format, default is <code node-type="code">raw</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_71">
              <span>export-public-key</span>
              <span>
                <code node-type="code">&lt;rfc7748-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_70">
              <span>export-public-key</span>
              <span>
                <code node-type="code">*key:x25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;rfc7748-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_69">
              <span>export-public-key</span>
              <span>
                <code node-type="code">&lt;rfc7748-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-public-key_68">
              <span>export-public-key</span>
              <span>
                <code node-type="code">*key:x448*</code>
              </span>
              <span>
                <code node-type="code">&lt;rfc7748-public-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports X25519 or X448 key from the given <code node-type="code">&lt;rfc7748-public-key&gt;</code>. The optional
<i node-type="i">format</i> controls the format of the exporting key. Default value
is <code node-type="code">raw</code>.</p>
          <p node-type="paragraph">If the first form is used, then the method automatically detects the key type.</p>
          <div node-type="define" class="define">
            <span>Macro</span>
            <a name="private-key-format_145">
              <span>private-key-format</span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">A macro returns a symbol representation of <i node-type="i">format</i>. The <i node-type="i">format</i> must be
either <code node-type="code">raw</code> or <code node-type="code">private-key-info</code>.</p>
          <p node-type="paragraph"><code node-type="code">raw</code>:
Imports/exports raw public key.
<code node-type="code">private-key-info</code>:
Imports/exports private key info or one asymmetric key.</p>
          <div node-type="define" class="define">
            <span>Enum set</span>
            <a name="*private-key-formats*_182">
              <span>*private-key-formats*</span>
            </a>
          </div>
          <p node-type="paragraph">Enum set of the <code node-type="code">private-key-format</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="private-key-format?_146">
              <span>private-key-format?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a member of <code node-type="code">private-key-format</code> enum.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_36">
              <span>import-private-key</span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span>
                <code node-type="code">'private-key-info</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_35">
              <span>import-private-key</span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span>
                <code node-type="code">'private-key-info</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports a private key from the <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code> which must
be a valid private key info or one asymmetric key.<br>The returning private key type is detected by the OID inside of the
private key info.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_34">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:rsa</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_33">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:rsa</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports a RSA private key from the <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>. The
format of the input must be a raw RSAPrivateKey.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_67">
              <span>export-private-key</span>
              <span>
                <code node-type="code">&lt;rsa-crt-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_66">
              <span>export-private-key</span>
              <span>
                <code node-type="code">*key:rsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;rsa-crt-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exporting RSA private key is only supported with CRT key.<br>Exports the given <code node-type="code">&lt;rsa-crt-private-key&gt;</code>. The optional <i node-type="i">format</i> controls
the format of the exporting key. Default value is <code node-type="code">raw</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_32">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:dsa</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_31">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:dsa</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports a DSA private key from the <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>. The
format of the input must be a raw DSAPrivateKey.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_65">
              <span>export-private-key</span>
              <span>
                <code node-type="code">&lt;dsa-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_64">
              <span>export-private-key</span>
              <span>
                <code node-type="code">*key:dsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;dsa-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports the given <code node-type="code">&lt;dsa-private-key&gt;</code>. The optional <i node-type="i">format</i> controls
the format of the exporting key. Default value is <code node-type="code">raw</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_30">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:ecdsa</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">ec-parameter</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_29">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:ecdsa</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">ec-parameter</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports a ECDSA private key from the <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>. The
format of the input must be a raw ECPrivateKey.<br>If the given raw key doesn't contain EC parameter, then the optional
<i node-type="i">ec-parameter</i> must be provided.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_63">
              <span>export-private-key</span>
              <span>
                <code node-type="code">&lt;ecdsa-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_62">
              <span>export-private-key</span>
              <span>
                <code node-type="code">*key:ecdsa*</code>
              </span>
              <span>
                <code node-type="code">&lt;ecdsa-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports the given <code node-type="code">&lt;ecdsa-private-key&gt;</code>. The optional <i node-type="i">format</i> controls
the format of the exporting key. Default value is <code node-type="code">raw</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_28">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:ed25519</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_27">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:ed25519</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_26">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:ed448</code>
              </span>
              <span>
                <code node-type="code">&lt;bytevector&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="import-private-key_25">
              <span>import-private-key</span>
              <span>
                <code node-type="code">*key:ed448</code>
              </span>
              <span>
                <code node-type="code">&lt;port&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Imports a Ed25519 or Ed448 private key from the <code node-type="code">&lt;bytevector&gt;</code> or <code node-type="code">&lt;port&gt;</code>.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_61">
              <span>export-private-key</span>
              <span>
                <code node-type="code">&lt;eddsa-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_60">
              <span>export-private-key</span>
              <span>
                <code node-type="code">*key:ed25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;eddsa-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="export-private-key_59">
              <span>export-private-key</span>
              <span>
                <code node-type="code">*key:ed448*</code>
              </span>
              <span>
                <code node-type="code">&lt;eddsa-private-key&gt;</code>
              </span>
              <span> :optional </span>
              <span>
                <i node-type="i">format</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Exports the given <code node-type="code">&lt;eddsa-private-key&gt;</code>. The optional <i node-type="i">format</i> controls
the format of the exporting key. Default value is <code node-type="code">raw</code>.<br>If the first form is used, then the exporting key type is detected
from the given key.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="calculate-key-agreement_11">
              <span>calculate-key-agreement</span>
              <span>
                <code node-type="code">*key:ecdh*</code>
              </span>
              <span>
                <code node-type="code">&lt;ecdsa-private-key&gt;</code>
              </span>
              <span>
                <code node-type="code">&lt;ecdsa-public-key&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="calculate-key-agreement_10">
              <span>calculate-key-agreement</span>
              <span>
                <code node-type="code">*key:x25519*</code>
              </span>
              <span>
                <code node-type="code">&lt;rfc7748-private-key&gt;</code>
              </span>
              <span>
                <code node-type="code">&lt;rfc7748-public-key&gt;</code>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="calculate-key-agreement_9">
              <span>calculate-key-agreement</span>
              <span>
                <code node-type="code">*key:x449*</code>
              </span>
              <span>
                <code node-type="code">&lt;rfc7748-private-key&gt;</code>
              </span>
              <span>
                <code node-type="code">&lt;rfc7748-public-key&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Calculate a secret key from the given private key and public key.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="oid-&gt;key-operation_15">
              <span>oid-&gt;key-operation</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="key-&gt;oid_3">
              <span>key-&gt;oid</span>
            </a>
          </div>
        </section>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.ciphers">Cipher library - (sagittarius crypto ciphers)</a>
        </h2>
        <p node-type="paragraph">The cipher library provides both symmetric and asymmetric cipher
operations.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto ciphers)_89">
            <span>(sagittarius crypto ciphers)</span>
          </a>
        </div>
        <p node-type="paragraph">The cipher library, this library exports the procedures listed below sections.</p>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Ciphers-parameters">Ciphers parameters</a>
          </h3>
          <p node-type="paragraph">Cipher parameters are parameters to pass to the cipher, such as
Initial Vector (IV).</p>
          <p node-type="paragraph">All the parameter value retriever accept optional argument. If it's
provided and the parameter is not or does not contain the target
parameter, then the default value is returned, otherwise <code node-type="code">&amp;assertion</code>
is signalled.</p>
          <p node-type="paragraph">NOTE: The cipher parameters are only used on symmetric ciphers.
Asymmetric ciphers use keywords.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter?_93">
              <span>cipher-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a cipher parameter, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">A cipher parameter can be a simple parameter or composite parameter
like the condition system.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-cipher-parameter_64">
              <span>make-cipher-parameter</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a composite cipher parameter whose contents are given <i node-type="i">parameter</i>s.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="round-parameter?_143">
              <span>round-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a round cipher parameter, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used all the modes.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-round-parameter_263">
              <span>make-round-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">round</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a round cipher parameter with the given <i node-type="i">round</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-rounds_88">
              <span>cipher-parameter-rounds</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">round</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="iv-parameter?_84">
              <span>iv-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a iv cipher parameter, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by CBC, CFB, OFB, CTR, LRW F8 and GCM, and all of the
modes require it.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-iv-parameter_201">
              <span>make-iv-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">iv</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a IV cipher parameter with the given <i node-type="i">iv</i>. The <i node-type="i">iv</i> is copied
during the creation so modifying the original value does not affect
the parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-iv_86">
              <span>cipher-parameter-iv</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">iv</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="counter-mode-parameter?_158">
              <span>counter-mode-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a counter mode cipher parameter,
otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by CTR mode and if it's not provided, then
<code node-type="code">*ctr-mode:big-endian*</code> is used.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-counter-mode-parameter_75">
              <span>make-counter-mode-parameter</span>
              <span>
                <i node-type="i">mode</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a counter mode parameter with the given <i node-type="i">mode</i>. The <i node-type="i">mode</i> must
be one of the following:</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="*ctr-mode:little-endian*_11">
              <span>*ctr-mode:little-endian*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="*ctr-mode:big-endian*_10">
              <span>*ctr-mode:big-endian*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="*ctr-mode:rfc3686_12">
              <span>*ctr-mode:rfc3686</span>
            </a>
          </div>
          <p node-type="paragraph">These modes are little-endian, big-endian, and IPSec ESP described
<a href="https://datatracker.ietf.org/doc/html/rfc3686">RFC 3686</a>, respectively.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-counter-mode_85">
              <span>cipher-parameter-counter-mode</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">counter-mode</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="tweak-parameter?_132">
              <span>tweak-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a tweak cipher parameter, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by LRW mode, and it's a required parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-tweak-parameter_316">
              <span>make-tweak-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">tweak</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a tweak cipher parameter with the given <i node-type="i">tweak</i>. The <i node-type="i">tweak</i>
is copied during the creation so modifying the original value does not
affect the parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-tweak_92">
              <span>cipher-parameter-tweak</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">tweak</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="salt-parameter?_6">
              <span>salt-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a salt cipher parameter, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by F8 mode, and it's a required parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-salt-parameter_268">
              <span>make-salt-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">salt</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a salt cipher parameter with the given <i node-type="i">salt</i>. The <i node-type="i">salt</i>
is copied during the creation so modifying the original value does not
affect the parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-salt_89">
              <span>cipher-parameter-salt</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">salt</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="nonce-parameter?_25">
              <span>nonce-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a nonce cipher parameter, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by EAX, OCB and OCB3. EAX doesn't require it,
others require it.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-nonce-parameter_235">
              <span>make-nonce-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">nonce</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a nonce cipher parameter with the given <i node-type="i">nonce</i>. The <i node-type="i">nonce</i>
is copied during the creation so modifying the original value does not
affect the parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-nonce_87">
              <span>cipher-parameter-nonce</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">nonce</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="aad-parameter?_0">
              <span>aad-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a aad cipher parameter, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by EAX and GCM. It's an optional parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-aad-parameter_16">
              <span>make-aad-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">aad</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a aad cipher parameter with the given <i node-type="i">aad</i>. The <i node-type="i">aad</i>
is copied during the creation so modifying the original value does not
affect the parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-aad_84">
              <span>cipher-parameter-aad</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">aad</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="tag-length-parameter?_0">
              <span>tag-length-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a tag length cipher parameter,
otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by OCB3 and it's a required parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-tag-length-parameter_308">
              <span>make-tag-length-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">tag-length</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a tag length cipher parameter with the given <i node-type="i">tag-length</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-tag-length_91">
              <span>cipher-parameter-tag-length</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">tag-length</code> field of the given <i node-type="i">parameter</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="tag-parameter?_1">
              <span>tag-parameter?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a tag length cipher parameter,
otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">This parameter is used by CCM and GCM-SIV (on decryption), and it's a
required parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-tag-parameter_309">
              <span>make-tag-parameter</span>
              <span> (</span>
              <span>
                <i node-type="i">tag</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a tag length cipher parameter with the given <i node-type="i">tag</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-parameter-tag_90">
              <span>cipher-parameter-tag</span>
              <span> (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>) :optional default</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves the <code node-type="code">tag</code> field of the given <i node-type="i">parameter</i>.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Ciphers">Ciphers</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-descriptor?_78">
              <span>cipher-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a cipher descriptor, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">A cipher descriptor is an object which holds encryption scheme information,
such as algorithm, key length, etc.<br>This object itself doesn't provide any cipher operations, to execute
them, users need to create a cipher object.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher-descriptor-name_77">
              <span>cipher-descriptor-name</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">cipher-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the name of the given <i node-type="i">descriptor</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="cipher?_101">
              <span>cipher?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a cipher object, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">A cipher object is an actual working object to operate cipher operation.<br>A cipher may holds operation state, and it is users' responsibility to
make sure not to mix up the state.</p>
          <div node-type="define" class="define">
            <span>Macro</span>
            <a name="cipher-direction_79">
              <span>cipher-direction</span>
              <span>
                <i node-type="i">direction</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">A macro returns a symbol representation of <i node-type="i">direction</i>. The <i node-type="i">direction</i>
must be either <code node-type="code">encrypt</code> or <code node-type="code">decrypt</code>.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Symmetric-ciphers">Symmetric ciphers</a>
          </h3>
          <p node-type="paragraph">Symmetric cipher can be either block cipher or stream cipher.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="symmetric-cipher-descriptor?_366">
              <span>symmetric-cipher-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a symmetric cipher descriptor,
otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="symmetric-cipher-descriptor-min-key-length_365">
              <span>symmetric-cipher-descriptor-min-key-length</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">symmetric-cipher-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns minimum key length of the given <i node-type="i">descriptor</i>'s algorithm.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="symmetric-cipher-descriptor-max-key-length_364">
              <span>symmetric-cipher-descriptor-max-key-length</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">symmetric-cipher-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns maximum key length of the given <i node-type="i">descriptor</i>'s algorithm.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="symmetric-cipher?_367">
              <span>symmetric-cipher?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a symmetric cipher object, otherwise <code node-type="code">#f</code>.</p>
          <h4 node-type="header-4">
            <a name="5-Block-ciphers">[5] Block ciphers</a>
          </h4>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-descriptor?_83">
              <span>block-cipher-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a block cipher descriptor,
otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">Currently, below encryption algorithms are supported:</p>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:aes*_194">
              <span>*scheme:aes*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:aes-128*_195">
              <span>*scheme:aes-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:aes-192*_196">
              <span>*scheme:aes-192*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:aes-256*_197">
              <span>*scheme:aes-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:blowfish*_198">
              <span>*scheme:blowfish*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:camellia*_199">
              <span>*scheme:camellia*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:cast-128*_200">
              <span>*scheme:cast-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:cast5*_201">
              <span>*scheme:cast5*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:des*_204">
              <span>*scheme:des*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:des3*_205">
              <span>*scheme:des3*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:desede*_206">
              <span>*scheme:desede*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:kasumi*_207">
              <span>*scheme:kasumi*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:khazad*_208">
              <span>*scheme:khazad*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:noekeon*_210">
              <span>*scheme:noekeon*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:rc2*_211">
              <span>*scheme:rc2*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:rc5*_212">
              <span>*scheme:rc5*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:rc6*_213">
              <span>*scheme:rc6*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:safer+*_215">
              <span>*scheme:safer+*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:safer-k128*_216">
              <span>*scheme:safer-k128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:safer-k64*_217">
              <span>*scheme:safer-k64*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:safer-sk128*_218">
              <span>*scheme:safer-sk128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:safer-sk64*_219">
              <span>*scheme:safer-sk64*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:seed*_220">
              <span>*scheme:seed*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:skipjack*_221">
              <span>*scheme:skipjack*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:twofish*_223">
              <span>*scheme:twofish*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:x-tea*_224">
              <span>*scheme:x-tea*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:multi2*_209">
              <span>*scheme:multi2*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Block cipher descriptor</span>
            <a name="*scheme:sm4*_222">
              <span>*scheme:sm4*</span>
            </a>
          </div>
          <p node-type="paragraph">Some of the algorithms are considered as broken cipher, such as DES.<br>It is users' responsibility to use those ciphers.</p>
          <p node-type="paragraph">NOTE: NIST recommends to use AES.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-descriptor-block-length_81">
              <span>block-cipher-descriptor-block-length</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">block-cipher-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns block size of the given <i node-type="i">descriptor</i>'s algorithm.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-descriptor-suggested-key-length_82">
              <span>block-cipher-descriptor-suggested-key-length</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">block-cipher-descriptor?</code>
              </span>
              <span>) :optional size</span>
            </a>
          </div>
          <p node-type="paragraph">Returns suggested key length of the given <i node-type="i">descriptor</i>'s algorithm.</p>
          <p node-type="paragraph">Most of the time, this returns the result of
the <code node-type="code">symmetric-cipher-descriptor-max-key-length</code> procedure.</p>
          <p node-type="paragraph">If the optional argument <i node-type="i">size</i> is provided, then it check the <i node-type="i">size</i> is
valid length of the key length.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mode-descriptor?_411">
              <span>mode-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a mode descriptor, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">Currently, below encryption modes are supported.</p>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:ecb*_166">
              <span>*mode:ecb*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:cbc*_161">
              <span>*mode:cbc*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:cfb*_163">
              <span>*mode:cfb*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:ofb*_173">
              <span>*mode:ofb*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:ctr*_164">
              <span>*mode:ctr*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:lrw*_170">
              <span>*mode:lrw*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:f8*_167">
              <span>*mode:f8*</span>
            </a>
          </div>
          <p node-type="paragraph">Mode descriptors for ECB, CBC, CFB, OFB, CTR, LRW and F8 respectively.</p>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:eax*_165">
              <span>*mode:eax*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:ocb*_171">
              <span>*mode:ocb*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:ocb3*_172">
              <span>*mode:ocb3*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:gcm*_168">
              <span>*mode:gcm*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:gcm-siv*_169">
              <span>*mode:gcm-siv*</span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Mode descriptor</span>
            <a name="*mode:ccm*_162">
              <span>*mode:ccm*</span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Mode descriptor for EAX, OCB, OCB3, GCM, GCM-SIV and CCM
respectively. These are authenticated encryption with assiciated data
(AEAD) modes.</p>
          <p node-type="paragraph">GCM-SIV and CCM are <code node-type="code">offline</code> mode, which means it requires to know
all the input ahead. So, cipher encryption or decryption procedures
don't return encrypted or decrypted values. Only the last block
handling will do. This also implies that the last block handling
may require output space more than input block size. To know the
required space, use <code node-type="code">block-cipher-last-block-size</code> procedure. See the example
for the detail usage.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mode-descriptor-name_410">
              <span>mode-descriptor-name</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">mode-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the name of the given <i node-type="i">descriptor</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher?_97">
              <span>block-cipher?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a block cipher object, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-block-cipher_54">
              <span>make-block-cipher</span>
              <span> (</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <code node-type="code">block-cipher-descriptor?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">mode</i>
              </span>
              <span>
                <code node-type="code">mode-descriptor</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">padding</i>
              </span>
              <span>
                <code node-type="code">pkcs7-padding</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a block cipher object of <i node-type="i">scheme</i> encryption scheme and
<i node-type="i">mode</i> encryption mode.<br><i node-type="i">padding</i> is used to encrypt or decrypt the last block of the plain text.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-block-length_76">
              <span>block-cipher-block-length</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the block length of the given <i node-type="i">cipher</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-init!_92">
              <span>block-cipher-init!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">direction</i>
              </span>
              <span>
                <code node-type="code">symbol?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialise the given <i node-type="i">cipher</i> for the given <i node-type="i">direction</i> purpose with
the given <i node-type="i">key</i> and <i node-type="i">parameter</i>.<br>The <i node-type="i">direction</i> must be a symbol returned by the <code node-type="code">cipher-direction</code> macro.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-init_91">
              <span>block-cipher-init</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">direction</i>
              </span>
              <span>
                <code node-type="code">symbol?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">symmetric-key?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">parameter</i>
              </span>
              <span>
                <code node-type="code">cipher-parameter?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialise the give <i node-type="i">cipher</i>. This procedure is an analogy to the
<code node-type="code">block-cipher-init!</code>, the difference is this procedure returns a
copy of the given <i node-type="i">cipher</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-encrypt!_88">
              <span>block-cipher-encrypt!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">pt</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ps</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ct</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">cs</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Encrypts the given plain text <i node-type="i">pt</i> from the position of <i node-type="i">ps</i>, and store the
cipher text into <i node-type="i">ct</i> from the position of <i node-type="i">cs</i>. Then returns the byte
size of the encrypted plain text.<br>The encryption is executed by the given <i node-type="i">cipher</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-encrypt_87">
              <span>block-cipher-encrypt</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">pt</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">ps</i>
              </span>
              <span> 0)</span>
            </a>
          </div>
          <p node-type="paragraph">Encrypts the given plain text <i node-type="i">pt</i> from the position of <i node-type="i">ps</i>, and
returns the cipher text.<br>The encryption is executed by the given <i node-type="i">cipher</i>.</p>
          <p node-type="paragraph">NOTE: the given <i node-type="i">pt</i> length and result cipher text length may differ
if the <i node-type="i">pt</i> length is not multiple of the cipher block size.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-last-block-size_93">
              <span>block-cipher-last-block-size</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">block</i>
              </span>
              <span> (or </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>))</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the required output space in bytes.</p>
          <p node-type="paragraph">This procedure is useful when the encryption mode is GCM-SIV or CCM.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-encrypt-last-block!_90">
              <span>block-cipher-encrypt-last-block!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">pt</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ps</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ct</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">cs</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Encrypts the given plain text <i node-type="i">pt</i> from the position of <i node-type="i">ps</i>, and store the
cipher text into <i node-type="i">ct</i> from the position of <i node-type="i">cs</i>. Then returns the byte
size of the encrypted plain text.<br>The encryption is executed by the given <i node-type="i">cipher</i>.</p>
          <p node-type="paragraph">This procedure consumes all the plain text, and applies padding if needed.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-encrypt-last-block_89">
              <span>block-cipher-encrypt-last-block</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">pt</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">ps</i>
              </span>
              <span> 0)</span>
            </a>
          </div>
          <p node-type="paragraph">Encrypts the given plain text <i node-type="i">pt</i> from the position of <i node-type="i">ps</i>, and
returns the cipher text.<br>The encryption is executed by the given <i node-type="i">cipher</i>.</p>
          <p node-type="paragraph">This procedure consumes all the plain text, and applies padding if needed.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-decrypt! _78">
              <span>block-cipher-decrypt! </span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ct</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">cs</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">pt</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ps</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Decrypts the given cipher text <i node-type="i">ct</i> from the position of <i node-type="i">cs</i>, store the
plain text info <i node-type="i">pt</i> from the position of <i node-type="i">cs</i>. Then returns the byte
size of the decrypted cipher text.
The decryption is executed by the given <i node-type="i">cipher</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-decrypt_77">
              <span>block-cipher-decrypt</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ct</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">cs</i>
              </span>
              <span> 0)</span>
            </a>
          </div>
          <p node-type="paragraph">Decrypts the given cipher text <i node-type="i">ct</i> from the position of <i node-type="i">cs</i>, and
returns the plain text.<br>The decryption is executed by the given <i node-type="i">cipher</i>.</p>
          <p node-type="paragraph">NOTE: the given <i node-type="i">ct</i> length and result plain text length may differ
if the <i node-type="i">ct</i> length is not multiple of the cipher block size.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-decrypt-last-block!_80">
              <span>block-cipher-decrypt-last-block!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ct</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">cs</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">pt</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ps</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Decrypts the given cipher text <i node-type="i">ct</i> from the position of <i node-type="i">cs</i>, store the
plain text info <i node-type="i">pt</i> from the position of <i node-type="i">cs</i>. Then returns the byte
size of the decrypted cipher text.</p>
          <p node-type="paragraph">This procedure applies unpadding if the <i node-type="i">cipher</i> is created with padding.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-decrypt-last-block_79">
              <span>block-cipher-decrypt-last-block</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ct</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">cs</i>
              </span>
              <span> 0)</span>
            </a>
          </div>
          <p node-type="paragraph">Decrypts the given cipher text <i node-type="i">ct</i> from the position of <i node-type="i">cs</i>, and
returns the plain text.<br>The decryption is executed by the given <i node-type="i">cipher</i>.</p>
          <p node-type="paragraph">This procedure applies unpadding if the <i node-type="i">cipher</i> is created with padding.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-done!_84">
              <span>block-cipher-done!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Cleanup the given <i node-type="i">cipher</i> and make it neutral state.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-update-aad!_95">
              <span>block-cipher-update-aad!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">aad</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span> 0) (</span>
              <span>
                <i node-type="i">length</i>
              </span>
              <span>
                <code node-type="code">(- (bytevector-length aad) start)</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Updating Additional Authentication Data <i node-type="i">aad</i> of the given <i node-type="i">cipher</i>.<br>Optional arguments restricts the range of the <i node-type="i">aad</i>.</p>
          <p node-type="paragraph">This procedure is effective on authenticated encryption modes.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-update-iv!_96">
              <span>block-cipher-update-iv!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">iv</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span> 0) (</span>
              <span>
                <i node-type="i">length</i>
              </span>
              <span>
                <code node-type="code">(- (bytevector-length aad) start)</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Updating Initial Vector <i node-type="i">iv</i> of the given <i node-type="i">cipher</i>.<br>Optional arguments restricts the range of the <i node-type="i">iv</i>.</p>
          <p node-type="paragraph">This procedure is effective only GCM mode.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-max-tag-length_94">
              <span>block-cipher-max-tag-length</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the max tag length of the given <i node-type="i">cipher</i>. If the cipher doesn't
support authentication tag, then it returns <code node-type="code">0</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-done/tag!_86">
              <span>block-cipher-done/tag!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">tag</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (</span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span> 0)</span>
            </a>
          </div>
          <p node-type="paragraph">If the <i node-type="i">cipher</i> is encryption mode, then the procedure stores the
authentication tag into the give <i node-type="i">tag</i> of the position starting
<i node-type="i">start</i>.</p>
          <p node-type="paragraph">If the <i node-type="i">cipher</i> is decryption mode, then the procedure validates the
given <i node-type="i">tag</i> against the cipher's authentication tag starting from the
position of <i node-type="i">start</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="block-cipher-done/tag_85">
              <span>block-cipher-done/tag</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">block-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">tag-len</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">This procedure is only for encryption mode.<br>Stores the <i node-type="i">cipher</i>'s authentication tag into the given <i node-type="i">tag</i>,
starting position of <i node-type="i">start</i>.</p>
          <h4 node-type="header-4">
            <a name="5-Stream-ciphers">[5] Stream ciphers</a>
          </h4>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="stream-cipher-descriptor?_265">
              <span>stream-cipher-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a stream cipher descriptor, otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">Currently, below encryption algorithms are supported:</p>
          <div node-type="define" class="define">
            <span>Stream cipher descriptor</span>
            <a name="*scheme:chacha20*_202">
              <span>*scheme:chacha20*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Stream cipher descriptor</span>
            <a name="*scheme:xchacha20*_225">
              <span>*scheme:xchacha20*</span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Stream cipher descriptor</span>
            <a name="*scheme:chacha20-poly1305*_203">
              <span>*scheme:chacha20-poly1305*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Stream cipher descriptor</span>
            <a name="*scheme:xchacha20-poly1305*_226">
              <span>*scheme:xchacha20-poly1305*</span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="stream-cipher-descriptor-aead?_264">
              <span>stream-cipher-descriptor-aead?</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">stream-cipher-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if given the <i node-type="i">descriptor</i> is a AEAD stream cipher, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="stream-cipher?_266">
              <span>stream-cipher?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a stream cipher object, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-stream-cipher_302">
              <span>make-stream-cipher</span>
              <span> (</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <code node-type="code">stream-cipher-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a stream cipher object of <i node-type="i">scheme</i> encryption scheme.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Asymmetric-ciphers">Asymmetric ciphers</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-cipher-descriptor?_66">
              <span>asymmetric-cipher-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is an asymmetric cipher descriptor,
otherwise <code node-type="code">#f</code>.</p>
          <p node-type="paragraph">Currently, below asymmetric encryption algorithms are supported:</p>
          <div node-type="define" class="define">
            <span>Asymmetric cipher descriptor</span>
            <a name="*scheme:rsa*_214">
              <span>*scheme:rsa*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-cipher?_71">
              <span>asymmetric-cipher?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is an asymmetric cipher, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-asymmetric-cipher_29">
              <span>make-asymmetric-cipher</span>
              <span> (</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <code node-type="code">asymmetric-cipher-descriptor?</code>
              </span>
              <span> :key </span>
              <span>
                <i node-type="i">encoding</i>
              </span>
              <span> :allow-other-keys</span>
            </a>
          </div>
          <p node-type="paragraph">Creates an asymmetric cipher of <i node-type="i">scheme</i>.<br>The <i node-type="i">encoding</i> specifies its encoding algorithm, default is <code node-type="code">oaep-encoding</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-cipher-init!_70">
              <span>asymmetric-cipher-init!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">asymmetric-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">asymmetric-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialise the given <i node-type="i">cipher</i> with the given <i node-type="i">key</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-cipher-init_69">
              <span>asymmetric-cipher-init</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">asymmetric-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <code node-type="code">asymmetric-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialise the given <i node-type="i">cipher</i> with the given <i node-type="i">key</i>. This procedure is an
analogy to the <code node-type="code">asymmetric-cipher-init!</code>, the differ is this procedure
returns a copy of the given <i node-type="i">cipher</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-cipher-encrypt-bytevector_68">
              <span>asymmetric-cipher-encrypt-bytevector</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">asymmetric-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">bv</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (start 0)</span>
            </a>
          </div>
          <p node-type="paragraph">Encrypts the given bytevector <i node-type="i">bv</i> with the given <i node-type="i">cipher</i> from the position
of <i node-type="i">start</i> and returns a bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-cipher-decrypt-bytevector_65">
              <span>asymmetric-cipher-decrypt-bytevector</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">asymmetric-cipher?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">bv</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional (start 0)</span>
            </a>
          </div>
          <p node-type="paragraph">Decrypts the given bytevector <i node-type="i">bv</i> with the given <i node-type="i">cipher</i> from the position
of <i node-type="i">start</i> and returns a bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="asymmetric-cipher-done!_67">
              <span>asymmetric-cipher-done!</span>
              <span> (</span>
              <span>
                <i node-type="i">cipher</i>
              </span>
              <span>
                <code node-type="code">asymmetric-cipher?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Cleanup the given <i node-type="i">cipher</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="oaep-encoding_0">
              <span>oaep-encoding</span>
            </a>
          </div>
          <p node-type="paragraph">Provides OAEP encoding scheme. This can be used for <code node-type="code">:encoding</code> keyword's
argument of the <code node-type="code">make-asymmetric-cipher</code> procedure.</p>
          <p node-type="paragraph">This encoding scheme accepts the following keyword arguments:</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">:digest</code>
            </dt>
            <dd>
              <p node-type="paragraph">A digest descriptor to be generate a digest for label provided by <code node-type="code">:label</code>
keyword. Default value is <code node-type="code">*digest:sha-1*</code></p>
            </dd>
            <dt>
              <code node-type="code">:label</code>
            </dt>
            <dd>
              <p node-type="paragraph">A label. Default value is <code node-type="code">#vu8()</code>.</p>
            </dd>
            <dt>
              <code node-type="code">:mgf</code>
            </dt>
            <dd>
              <p node-type="paragraph">MGF function. Default value is <code node-type="code">mgf-1</code>.</p>
            </dd>
            <dt>
              <code node-type="code">:mgf-digest</code>
            </dt>
            <dd>
              <p node-type="paragraph">A digest descriptor to be used by the <code node-type="code">:mgf</code>'s argument. Default value is
<code node-type="code">*digest:sha-1*</code>.</p>
            </dd>
            <dt>
              <code node-type="code">:prng</code>
            </dt>
            <dd>
              <p node-type="paragraph">A pseudo random generator to generate padding. Default value is
<code node-type="code">(secure-random-generator *prng:chacha20*)</code>.</p>
            </dd>
          </dl>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="pkcs1-v1.5-encoding_87">
              <span>pkcs1-v1.5-encoding</span>
            </a>
          </div>
          <p node-type="paragraph">Provides PKCS#1.5 encoding scheme. This can be used for <code node-type="code">:encoding</code> keyword's
arguments of the <code node-type="code">make-asymmetric-cipher</code> procedure.</p>
          <p node-type="paragraph">This encoding scheme accepts the following keyword arguments:</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">:prng</code>
            </dt>
            <dd>
              <p node-type="paragraph">A pseudo random generator to generate padding. Default value is
<code node-type="code">(secure-random-generator *prng:chacha20*)</code>.</p>
            </dd>
          </dl>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mgf-1_402">
              <span>mgf-1</span>
            </a>
          </div>
          <p node-type="paragraph">MGF-1 procedure. This can be used to <code node-type="code">:mgf</code> keyword's argument of the
<code node-type="code">oaep-encoding</code>.</p>
        </section>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.digests">Digest library - (sagittarius crypto digests)</a>
        </h2>
        <p node-type="paragraph">The digest library provides cryptographic hash functions.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto digests)_90">
            <span>(sagittarius crypto digests)</span>
          </a>
        </div>
        <p node-type="paragraph">The digest library, this library exports the procedures listed below sections.</p>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Digest-descriptor">Digest descriptor</a>
          </h3>
          <p node-type="paragraph">A digest descriptor describes the characteristic of the digest, such as
name, digest size (if applicable), block size and OID (if exists).</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="digest-descriptor?_140">
              <span>digest-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a digest descriptor, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="digest-descriptor-name_138">
              <span>digest-descriptor-name</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">digest-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the human readable name of the <i node-type="i">descriptor</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="digest-descriptor-digest-size_137">
              <span>digest-descriptor-digest-size</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">digest-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the digest size of the <i node-type="i">descriptor</i>. Some of the digests,
e.g. SHAKE, don't have fixed digest size.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="digest-descriptor-block-size_136">
              <span>digest-descriptor-block-size</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">digest-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the block size of the <i node-type="i">descriptor</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="digest-descriptor-oid_139">
              <span>digest-descriptor-oid</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">digest-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the OID of the <i node-type="i">descriptor</i>. If the digest doesn't have OID, then
it returns <code node-type="code">#f</code>.</p>
          <hr>
          <p node-type="paragraph">Blow are the digest descriptors supported by this library:</p>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:whirlpool*_48">
              <span>*digest:whirlpool*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:ripemd-128*_30">
              <span>*digest:ripemd-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:ripemd-160*_31">
              <span>*digest:ripemd-160*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:ripemd-256*_32">
              <span>*digest:ripemd-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:ripemd-320*_33">
              <span>*digest:ripemd-320*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha-1*_34">
              <span>*digest:sha-1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha-224*_35">
              <span>*digest:sha-224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha-256*_36">
              <span>*digest:sha-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha-384*_37">
              <span>*digest:sha-384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha-512*_38">
              <span>*digest:sha-512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha-512/224*_39">
              <span>*digest:sha-512/224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha-512/256*_40">
              <span>*digest:sha-512/256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha3-224* _41">
              <span>*digest:sha3-224* </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha3-256* _42">
              <span>*digest:sha3-256* </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha3-384*_43">
              <span>*digest:sha3-384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:sha3-512*_44">
              <span>*digest:sha3-512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:keccak-224*_23">
              <span>*digest:keccak-224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:keccak-256*_24">
              <span>*digest:keccak-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:keccak-384*_25">
              <span>*digest:keccak-384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:keccak-512*_26">
              <span>*digest:keccak-512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:tiger-192*_47">
              <span>*digest:tiger-192*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:md5*_29">
              <span>*digest:md5*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:md4*_28">
              <span>*digest:md4*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:md2*_27">
              <span>*digest:md2*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2s-128*_17">
              <span>*digest:blake2s-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2s-160*_18">
              <span>*digest:blake2s-160*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2s-224*_19">
              <span>*digest:blake2s-224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2s-256*_20">
              <span>*digest:blake2s-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2b-160*_13">
              <span>*digest:blake2b-160*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2b-256*_14">
              <span>*digest:blake2b-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2b-384*_15">
              <span>*digest:blake2b-384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:blake2b-512*_16">
              <span>*digest:blake2b-512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:shake-128*_45">
              <span>*digest:shake-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:shake-256*_46">
              <span>*digest:shake-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:cshake-128*_21">
              <span>*digest:cshake-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Digest descriptor</span>
            <a name="*digest:cshake-256*_22">
              <span>*digest:cshake-256*</span>
            </a>
          </div>
          <p node-type="paragraph">We supports weak / broken digest algorithms, such as MD5. It is users'
responsibility to choose appropriate algorithm.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Message-Digest">Message Digest</a>
          </h3>
          <p node-type="paragraph">Message Digest is a stateful object which ingests input and provides
digests.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="message-digest?_399">
              <span>message-digest?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a message digest, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-message-digest_224">
              <span>make-message-digest</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">digest-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a message digest of the algorithm <i node-type="i">descriptor</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="message-digest-descriptor_393">
              <span>message-digest-descriptor</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the digest descriptor of given <i node-type="i">md</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="message-digest-digest-size_394">
              <span>message-digest-digest-size</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the digest size of given <i node-type="i">md</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="digest-message_141">
              <span>digest-message</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">msg</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns the digest of the given <i node-type="i">msg</i>.<br>The optional argument <i node-type="i">length</i> is only required for the variable
length digest algorithms, such as SHAKE. Otherwise, the value will be
ignored.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="digest-message!_142">
              <span>digest-message!</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">msg</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">out</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Digests the given <i node-type="i">msg</i>, then fill the result into the <i node-type="i">out</i>.<br>Optional argument <i node-type="i">start</i> and <i node-type="i">length</i> specify the start position of the
<i node-type="i">out</i> and the length of the filling.</p>
          <hr>
          <p node-type="paragraph">Below procedures are low level APIs which can be used not to allocate
entire input buffer, say using <code node-type="code">get-bytevector-n!</code> instead of
<code node-type="code">get-bytevector-all</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="message-digest-init!_397">
              <span>message-digest-init!</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialises the given <i node-type="i">md</i>. This procedure rests the previous input as well.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="message-digest-process!_398">
              <span>message-digest-process!</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">msg</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Ingests the given <i node-type="i">msg</i> into <i node-type="i">md</i>.<br>Optional argument <i node-type="i">start</i> and <i node-type="i">length</i> controls the range of the <i node-type="i">msg</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="message-digest-done!_396">
              <span>message-digest-done!</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">out</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Fill the result digest of <i node-type="i">md</i> into the <i node-type="i">out</i>.<br>Optional argument <i node-type="i">start</i> and <i node-type="i">length</i> controls the range of the <i node-type="i">out</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="message-digest-done_395">
              <span>message-digest-done</span>
              <span> (</span>
              <span>
                <i node-type="i">md</i>
              </span>
              <span>
                <code node-type="code">message-digest?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns a freshly allocated bytevector whose content is the result of
<i node-type="i">md</i>, digest.<br>Optional argument <i node-type="i">length</i> is only used for the variable length digest
algorithm, such as SHAKE. Otherwise it will be ignored.</p>
        </section>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.random">Random library - (sagittarius crypto random)</a>
        </h2>
        <p node-type="paragraph">The random library provides cryptographically secure random number
generator (CSPRNG) operations.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto random)_95">
            <span>(sagittarius crypto random)</span>
          </a>
        </div>
        <p node-type="paragraph">The random library, this library exports the procedures listed below sections.</p>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="PRNG-descriptor">PRNG descriptor</a>
          </h3>
          <p node-type="paragraph">PRNG descriptor is a representation of pseudo random generator (PRNG).</p>
          <div node-type="define" class="define">
            <span>Library</span>
            <a name="prng-descriptor?_150">
              <span>prng-descriptor?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a PRNG descriptor, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Library</span>
            <a name="prng-descriptor-name_149">
              <span>prng-descriptor-name</span>
              <span> (</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <code node-type="code">prng-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns a human readable name of the given <i node-type="i">descriptor</i>.</p>
          <hr>
          <p node-type="paragraph">Below are the supported PRNGs.</p>
          <div node-type="define" class="define">
            <span>PRNG descriptor</span>
            <a name="*prng:yarrow*_188">
              <span>*prng:yarrow*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>PRNG descriptor</span>
            <a name="*prng:fortuna*_184">
              <span>*prng:fortuna*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>PRNG descriptor</span>
            <a name="*prng:rc4*_185">
              <span>*prng:rc4*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>PRNG descriptor</span>
            <a name="*prng:sober-128*_186">
              <span>*prng:sober-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>PRNG descriptor</span>
            <a name="*prng:chacha20*_183">
              <span>*prng:chacha20*</span>
            </a>
          </div>
          <p node-type="paragraph">These are the PRNG algorithms, Yarrow, Fortuna RC4, Sober-128 and ChaCha20,
respectively.</p>
          <div node-type="define" class="define">
            <span>PRNG descriptor</span>
            <a name="*prng:system*_187">
              <span>*prng:system*</span>
            </a>
          </div>
          <p node-type="paragraph">This is a system, platform dependent, PRNG. For example, this PRNG reads
from file descriptor of <code node-type="code">/dev/urandom</code> on Linux or other POSIX environment
if the device exists.</p>
          <p node-type="paragraph">Ths PRNG is slow as it requires I/O. Also can't be pseudo random generator
described below.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Random-generator">Random generator</a>
          </h3>
          <p node-type="paragraph">Random generator has a hierachical class structure. If you only use
the provided PRNGs, you don't have to care about it. However, if you
want to make a custom algorithm which is not supported by the library,
then you may need to know how to enhance it. Creating a custom random
generator is described the below section.</p>
          <pre lang="" node-type="block"><code>                               &lt;random-generator&gt;
                                       |
           +---------------------------+------------------------+
           |                           |                        |
&lt;builtin-random-generator&gt; &lt;secure-random-generator&gt; &lt;custom-random-generator&gt;
           |                           |
           +-------------+-------------+
                         |
         &lt;builtin-secure-random-generator&gt;
</code></pre>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="random-generator?_14">
              <span>random-generator?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a random generator, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="builtin-random-generator?_109">
              <span>builtin-random-generator?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a builtin random generator, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="secure-random-generator?_12">
              <span>secure-random-generator?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a secure random generator, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="custom-random-generator?_194">
              <span>custom-random-generator?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a custom random generator, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="random-generator-read-random-bytes_10">
              <span>random-generator-read-random-bytes</span>
              <span> (</span>
              <span>
                <i node-type="i">random-generator</i>
              </span>
              <span>
                <code node-type="code">random-generator?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">size</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns a bytevector of length <i node-type="i">size</i> filled with random data read from the
given <i node-type="i">random-generator</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="random-generator-read-random-bytes!_11">
              <span>random-generator-read-random-bytes!</span>
              <span> (</span>
              <span>
                <i node-type="i">random-generator</i>
              </span>
              <span>
                <code node-type="code">random-generator?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">out</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Reads random data from <i node-type="i">random-generator</i>, and fill them into <i node-type="i">out</i>.<br>If optional arguments <i node-type="i">starts</i> and <i node-type="i">length</i> are specified, then it specifies
the range of the output bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="random-generator-randomize!_9">
              <span>random-generator-randomize!</span>
              <span> (</span>
              <span>
                <i node-type="i">random-generator</i>
              </span>
              <span>
                <code node-type="code">random-generator?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">seed</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Add entropy <i node-type="i">seed</i> to the given <i node-type="i">random-generator</i>.<br>If optional arguments <i node-type="i">starts</i> and <i node-type="i">length</i> are specified, then it specifies
the range of the <i node-type="i">seed</i> bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="random-generator-random-integer_8">
              <span>random-generator-random-integer</span>
              <span> (</span>
              <span>
                <i node-type="i">random-generator</i>
              </span>
              <span>
                <code node-type="code">random-generator?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">bound</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns a random integer of range 0 &lt;= n &lt;= <i node-type="i">bound</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="pseudo-random-generator_165">
              <span>pseudo-random-generator</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="secure-random-generator_11">
              <span>secure-random-generator</span>
              <span>
                <i node-type="i">descriptor</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a pseudo or secure random generator, respectively.<br>If the given <i node-type="i">descriptor</i> is PRNG descrptor, then these procedure
creates builtin random generator ignoreing the given <i node-type="i">opts</i>.<br>If the given <i node-type="i">descriptor</i> is not PRNG descrptor, then these procedure
call <code node-type="code">make-custom-random-generator</code> method passing <i node-type="i">descriptor</i> and
<i node-type="i">opts</i>.</p>
          <p node-type="paragraph">If <code node-type="code">secure-random-generator</code> is used, then <code node-type="code">make-custom-random-generator</code>
receives <code node-type="code">:secure-random</code> keyword argument with value of <code node-type="code">#t</code>, so that
the receiver can handle it properly.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="random-generator-state_13">
              <span>random-generator-state</span>
              <span>
                <code node-type="code">&lt;random-generator&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Gets the state of given <code node-type="code">&lt;random-generator&gt;</code> if it's supported.<br>By default this method returns <code node-type="code">#f</code>, means not supported.</p>
          <div node-type="define" class="define">
            <span>Method</span>
            <a name="random-generator-state_12">
              <span>random-generator-state</span>
              <span>
                <code node-type="code">&lt;random-generator&gt;</code>
              </span>
              <span>
                <code node-type="code">&lt;any&gt;</code>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Sets the given state represented by <code node-type="code">&lt;any&gt;</code> to <code node-type="code">&lt;random-generator&gt;</code>
if it's supported.<br>By default this method does nothing and returns <code node-type="code">#f</code>, means not supported.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Custom-random-generator">Custom random generator</a>
          </h3>
          <div node-type="define" class="define">
            <span>Class</span>
            <a name="<custom-random-generator&gt;_17">
              <span>&lt;custom-random-generator&gt;</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Generic</span>
            <a name="make-custom-random-generator_80">
              <span>make-custom-random-generator</span>
            </a>
          </div>
        </section>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.signatures">Signature library - (sagittarius crypto signatures)</a>
        </h2>
        <p node-type="paragraph">The signature library provides signature generation / verification
operations.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto signatures)_96">
            <span>(sagittarius crypto signatures)</span>
          </a>
        </div>
        <p node-type="paragraph">The signature library, this library exports the procedures listed
below sections.</p>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Algorithms">Algorithms</a>
          </h3>
          <p node-type="paragraph">Below are the algorithms supported by the library.</p>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:rsa*_262">
              <span>*signature:rsa*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:dsa*_254">
              <span>*signature:dsa*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:ecdsa*_255">
              <span>*signature:ecdsa*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:eddsa*_261">
              <span>*signature:eddsa*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:ed25519*_256">
              <span>*signature:ed25519*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:ed25519ctx*_257">
              <span>*signature:ed25519ctx*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:ed25519ph*_258">
              <span>*signature:ed25519ph*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:ed448*_259">
              <span>*signature:ed448*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Signature algorithm</span>
            <a name="*signature:ed448ph*_260">
              <span>*signature:ed448ph*</span>
            </a>
          </div>
          <p node-type="paragraph">These algorithms can be used both signer and verifier.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Signer">Signer</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="signer?_112">
              <span>signer?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a signer, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-signer_280">
              <span>make-signer</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a signer of the <i node-type="i">scheme</i>. The <i node-type="i">scheme</i> must be one of the
signature algorithms listed above. The <i node-type="i">key</i> must be an appropriate
private key for the specified <i node-type="i">scheme</i>.</p>
          <p node-type="paragraph"><i node-type="i">opts</i> must be a keyword arguments, the procedure ignores unsupported
keywords. The supporting keyword arguments and its scheme are below</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">:digest</code>
            </dt>
            <dd>
              <p node-type="paragraph">For all signature algorithms. Specifying digest algorithm. Most of
the algorithm uses <code node-type="code">*digest:sha-256*</code> as its default digest algorithm.</p>
            </dd>
            <dt>
              <code node-type="code">:encoder</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:rsa*</code>. Specifying signature encoding, default value
is <code node-type="code">pkcs1-emsa-pss-encode</code>.</p>
            </dd>
            <dt>
              <code node-type="code">:k-generator</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:dsa*</code> and <code node-type="code">*signature:ecdsa*</code>. Specifying <i node-type="i">k</i> generator.
It uses random generator as default value.</p>
            </dd>
            <dt>
              <code node-type="code">:der-encode</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:dsa*</code> and <code node-type="code">*signature:ecdsa*</code>. Specifying if the result
signature is DER encoded or not. Default value is <code node-type="code">#t</code>.</p>
            </dd>
            <dt>
              <code node-type="code">:scheme</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:eddsa*</code>. Specifying EdDSA scheme.</p>
            </dd>
            <dt>
              <code node-type="code">:context</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:eddsa*</code> <code node-type="code">*signature:ed25519ctx*</code>, <code node-type="code">*signature:ed25519ph*</code>,
<code node-type="code">*signature:ed448*</code>, and <code node-type="code">*signature:ed448ph*</code>.
Specifying context, default value is <code node-type="code">#vu8()</code>.</p>
            </dd>
          </dl>
          <p node-type="paragraph">For the scheme specific procedures such as <code node-type="code">k-generator</code>, see the below
sections.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="signer-sign-message_111">
              <span>signer-sign-message</span>
              <span> (</span>
              <span>
                <i node-type="i">signer</i>
              </span>
              <span>
                <code node-type="code">signer?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Signs the given <i node-type="i">message</i> with <i node-type="i">signer</i> and returns the signature.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="signer-init!_108">
              <span>signer-init!</span>
              <span> (</span>
              <span>
                <i node-type="i">signer</i>
              </span>
              <span>
                <code node-type="code">signer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialises the given <i node-type="i">signer</i></p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="signer-process!_109">
              <span>signer-process!</span>
              <span> (</span>
              <span>
                <i node-type="i">signer</i>
              </span>
              <span>
                <code node-type="code">signer?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Feeds the given <i node-type="i">message</i> to the <i node-type="i">signer</i>. The optional arguments specifies
the range of the <i node-type="i">message</i> to feed.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="signer-sign!_110">
              <span>signer-sign!</span>
              <span> (</span>
              <span>
                <i node-type="i">signer</i>
              </span>
              <span>
                <code node-type="code">signer?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Signs the accumulated message of <i node-type="i">signer</i> and returns a bytevector.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Verifier">Verifier</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="verifier?_42">
              <span>verifier?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is a verifier, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-verifier_326">
              <span>make-verifier</span>
              <span>
                <i node-type="i">scheme</i>
              </span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a verifier of the <i node-type="i">scheme</i>. The <i node-type="i">scheme</i> must be one of the
signature algorithms listed above. The <i node-type="i">key</i> must be an appropriate
public key for the specified <i node-type="i">scheme</i>.</p>
          <p node-type="paragraph"><i node-type="i">opts</i> must be a keyword arguments, the procedure ignores unsupported
keywords. The supporting keyword arguments and its scheme are below</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">:digest</code>
            </dt>
            <dd>
              <p node-type="paragraph">For all signature algorithms. Specifying digest algorithm. Most of
the algorithm uses <code node-type="code">*digest:sha-256*</code> as its default digest algorithm.</p>
            </dd>
            <dt>
              <code node-type="code">:verifier</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:rsa*</code>. Specifying signature encoding, default value
is <code node-type="code">pkcs1-emsa-pss-verify</code>.</p>
            </dd>
            <dt>
              <code node-type="code">:der-encode</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:dsa*</code> and <code node-type="code">*signature:ecdsa*</code>. Specifying if the result
signature is DER encoded or not. Default value is <code node-type="code">#t</code>.</p>
            </dd>
            <dt>
              <code node-type="code">:scheme</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:eddsa*</code>. Specifying EdDSA scheme.</p>
            </dd>
            <dt>
              <code node-type="code">:context</code>
            </dt>
            <dd>
              <p node-type="paragraph">For <code node-type="code">*signature:eddsa*</code> <code node-type="code">*signature:ed25519ctx*</code>, <code node-type="code">*signature:ed25519ph*</code>,
<code node-type="code">*signature:ed448*</code>, and <code node-type="code">*signature:ed448ph*</code>.
Specifying context, default value is <code node-type="code">#vu8()</code>.</p>
            </dd>
          </dl>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="verifier-verify-signature_41">
              <span>verifier-verify-signature</span>
              <span> (</span>
              <span>
                <i node-type="i">verifier</i>
              </span>
              <span>
                <code node-type="code">verifier?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">signature</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Verifies if the given <i node-type="i">signature</i> is valid signature of the given <i node-type="i">message</i>
with <i node-type="i">verifier</i>.</p>
          <p node-type="paragraph">It returns <code node-type="code">#t</code> if the given <i node-type="i">signature</i> is a valid signature.<br>If the signature verification is failed, then returns <code node-type="code">#f</code>.<br>If the signature format is not valid, then raise an error.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="verifier-init!_38">
              <span>verifier-init!</span>
              <span> (</span>
              <span>
                <i node-type="i">verifier</i>
              </span>
              <span>
                <code node-type="code">verifier?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialises the given <i node-type="i">verifier</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="verifier-process!_39">
              <span>verifier-process!</span>
              <span> (</span>
              <span>
                <i node-type="i">verifier</i>
              </span>
              <span>
                <code node-type="code">verifier?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Feeds the given <i node-type="i">message</i> to the <i node-type="i">verifier</i>. The optional arguments specifies
the range of the <i node-type="i">message</i> to feed.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="verifier-verify!_40">
              <span>verifier-verify!</span>
              <span>  (</span>
              <span>
                <i node-type="i">verifier</i>
              </span>
              <span>
                <code node-type="code">verifier?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">signature</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Verifies the given <i node-type="i">signature</i> against the accumulated messgage.</p>
          <p node-type="paragraph">It returns <code node-type="code">#t</code> if the given <i node-type="i">signature</i> is a valid signature.<br>If the signature verification is failed, then returns <code node-type="code">#f</code>.<br>If the signature format is not valid, then raise an error.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="RSA-signature-specific">RSA signature specific</a>
          </h3>
          <p node-type="paragraph">These procedures are RSA signature specific, i.e. <code node-type="code">:encoder</code> and <code node-type="code">:verifier</code>
keyword arguments, the keyword arguments specified in these procedures
are passed via either <code node-type="code">make-signer</code> or <code node-type="code">make-verifier</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="pkcs1-emsa-pss-encode_80">
              <span>pkcs1-emsa-pss-encode</span>
              <span> :key salt (mgf </span>
              <span>
                <code node-type="code">mgf-1</code>
              </span>
              <span>) mgf-digest</span>
            </a>
          </div>
          <p node-type="paragraph">PKCS#1 EMSA PSS encode. The keyword arguments specifies its salt, MGF and
digest algorithm of the MGF.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="pkcs1-emsa-pss-verify_82">
              <span>pkcs1-emsa-pss-verify</span>
              <span> :key salt-length (mgf </span>
              <span>
                <code node-type="code">mgf-1</code>
              </span>
              <span>) mgf-digest</span>
            </a>
          </div>
          <p node-type="paragraph">PKCS#1 EMSA PSS verify. The keyword arguments specifies its salt, MGF and
digest algorithm of the MGF.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="pkcs1-emsa-v1.5-encode_84">
              <span>pkcs1-emsa-v1.5-encode</span>
            </a>
          </div>
          <p node-type="paragraph">PKCS#1 EMSA PKCS1-v1_5 encode.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="pkcs1-emsa-v1.5-verify_86">
              <span>pkcs1-emsa-v1.5-verify</span>
            </a>
          </div>
          <p node-type="paragraph">PKCS#1 EMSA PKCS1-v1_5 verify.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mgf-1_401">
              <span>mgf-1</span>
            </a>
          </div>
          <p node-type="paragraph">MGF1 function, the same as the one exported from <code node-type="code">(sagittarius crypto ciphers)</code>.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="DSA-and-ECDSA-signature-specific">DSA and ECDSA signature specific</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-random-k-generator_250">
              <span>make-random-k-generator</span>
              <span> (</span>
              <span>
                <i node-type="i">prng</i>
              </span>
              <span>
                <code node-type="code">random-generator?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a random k-generator.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-hmac-k-generator_177">
              <span>make-hmac-k-generator</span>
              <span> (</span>
              <span>
                <i node-type="i">digest</i>
              </span>
              <span>
                <code node-type="code">digest-descriptor?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a RFC 6979 determistic k-generator.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Supporting-algorithms-OIDs">Supporting algorithms' OIDs</a>
          </h3>
          <p node-type="paragraph">The below bindings are string representaion of OIDs which can be used
to create X.509 algorithm identifier, i.e. <code node-type="code">make-x509-algorithm-identifier</code>,
described in X.509 library.</p>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha1*_242">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha256*_244">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha384*_249">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha512*_250">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha224*_243">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha512/224*_251">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha512/224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha512/256*_252">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha512/256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha3-224*_245">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha3-224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha3-256*_246">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha3-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha3-384*_247">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha3-384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-pkcs-v1.5-sha3-512*_248">
              <span>*signature-algorithm:rsa-pkcs-v1.5-sha3-512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:rsa-ssa-pss*_253">
              <span>*signature-algorithm:rsa-ssa-pss*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:dsa-sha224*_227">
              <span>*signature-algorithm:dsa-sha224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:dsa-sha256*_228">
              <span>*signature-algorithm:dsa-sha256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:dsa-sha384*_229">
              <span>*signature-algorithm:dsa-sha384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:dsa-sha512*_230">
              <span>*signature-algorithm:dsa-sha512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha1*_231">
              <span>*signature-algorithm:ecdsa-sha1*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha224*_232">
              <span>*signature-algorithm:ecdsa-sha224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha256*_233">
              <span>*signature-algorithm:ecdsa-sha256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha384*_238">
              <span>*signature-algorithm:ecdsa-sha384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha512*_239">
              <span>*signature-algorithm:ecdsa-sha512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha3-224*_234">
              <span>*signature-algorithm:ecdsa-sha3-224*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha3-256*_235">
              <span>*signature-algorithm:ecdsa-sha3-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha3-384*_236">
              <span>*signature-algorithm:ecdsa-sha3-384*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ecdsa-sha3-512*_237">
              <span>*signature-algorithm:ecdsa-sha3-512*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ed25519*_240">
              <span>*signature-algorithm:ed25519*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Constant</span>
            <a name="*signature-algorithm:ed448*_241">
              <span>*signature-algorithm:ed448*</span>
            </a>
          </div>
          <p node-type="paragraph">The name must be descriptive enough to see which algorithm of OID it
represents.</p>
        </section>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.mac">MAC library - (sagittarius crypto mac)</a>
        </h2>
        <p node-type="paragraph">The Message Authentication Code, MAC, library provides MAC
generation / verification operations.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto mac)_94">
            <span>(sagittarius crypto mac)</span>
          </a>
        </div>
        <p node-type="paragraph">The MAC library, this library exports the procedures listed
below sections.</p>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Algorithms">Algorithms</a>
          </h3>
          <p node-type="paragraph">Below are the MAC algorithms supported by the library.</p>
          <div node-type="define" class="define">
            <span>MAC algorithm</span>
            <a name="*mac:hmac*_145">
              <span>*mac:hmac*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>MAC algorithm</span>
            <a name="*mac:cmac*_143">
              <span>*mac:cmac*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>MAC algorithm</span>
            <a name="*mac:gmac*_144">
              <span>*mac:gmac*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>MAC algorithm</span>
            <a name="*mac:kmac*_146">
              <span>*mac:kmac*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>MAC algorithm</span>
            <a name="*mac:kmac-128*_147">
              <span>*mac:kmac-128*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>MAC algorithm</span>
            <a name="*mac:kmac-256*_148">
              <span>*mac:kmac-256*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mac?_10">
              <span>mac?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is MAC object, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-mac_219">
              <span>make-mac</span>
              <span>
                <i node-type="i">type</i>
              </span>
              <span>
                <i node-type="i">key</i>
              </span>
              <span>
                <i node-type="i">opts</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a MAC object of algorithm <i node-type="i">type</i>.<br><i node-type="i">key</i> must be an appropriate shared secret per <i node-type="i">type</i>. At this moment,
all the algorithms require bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mac-type_9">
              <span>mac-type</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns the type of given <i node-type="i">mac</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mac-mac-size_5">
              <span>mac-mac-size</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns MAC size of the given <i node-type="i">mac</i>, if the MAC size is fixed,
otherwise <code node-type="code">#f</code>.<br>Only KMAC is variable length.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mac-oid_6">
              <span>mac-oid</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns OID of the <i node-type="i">mac</i>, if it has, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="generate-mac_15">
              <span>generate-mac</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Generates MAC of given <i node-type="i">message</i> by <i node-type="i">mac</i>.<br>Optional argument <i node-type="i">length</i> specifies the length of returning bytevector.</p>
          <p node-type="paragraph">NOTE: <i node-type="i">length</i> doesn't guarantee the bytevector is filled with MAC. If the
MAC size is shorter than <i node-type="i">length</i>, then excess values are filled with 0.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="generate-mac!_17">
              <span>generate-mac!</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">out</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Generates MAC of given <i node-type="i">message</i> by <i node-type="i">mac</i> and fills it in the <i node-type="i">out</i> from
position <i node-type="i">start</i> to <i node-type="i">length</i> count.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="verify-mac_45">
              <span>verify-mac</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">auth-mac</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Verifies if the given <i node-type="i">auth-mac</i> is MAC of <i node-type="i">message</i> by <i node-type="i">mac</i> and returns <code node-type="code">#t</code>
if the MAC is verified, otherwise signals an error.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mac-init!_4">
              <span>mac-init!</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Initialises the given <i node-type="i">mac</i>. If this procedure is called during the
message processing, then the previous state will be reset.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mac-process!_8">
              <span>mac-process!</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">message</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Processes the given <i node-type="i">message</i> with <i node-type="i">mac</i>.<br>Optional arguments specifies the range of <i node-type="i">message</i> to be processed.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="mac-done!_2">
              <span>mac-done!</span>
              <span> (</span>
              <span>
                <i node-type="i">mac</i>
              </span>
              <span>
                <code node-type="code">mac?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">out</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">start</i>
              </span>
              <span>
                <i node-type="i">length</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Generates MAC by <i node-type="i">mac</i> and fills it into the <i node-type="i">out</i> from position
_start to <i node-type="i">length</i> count.</p>
        </section>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.x509">X.509 library - (sagittarius crypto x509)</a>
        </h2>
        <p node-type="paragraph">The X.509 library provides X.509 certificate, CRL, CSR and some
other related operations.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto x509)_97">
            <span>(sagittarius crypto x509)</span>
          </a>
        </div>
        <p node-type="paragraph">The X.509 library, this library exports the procedures listed
below sections.</p>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-certificate">X.509 certificate</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate?_51">
              <span>x509-certificate?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 certificate, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="bytevector-&gt;x509-certificate_125">
              <span>bytevector-&gt;x509-certificate</span>
              <span> (</span>
              <span>
                <i node-type="i">bv</i>
              </span>
              <span>
                <code node-type="code">bygevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts the given bytevector <i node-type="i">bv</i> to X.509 certificate. The bytevector
must be a valid X.509 certificate structure otherwise an error is signalled.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="read-x509-certificate_56">
              <span>read-x509-certificate</span>
              <span> (</span>
              <span>
                <i node-type="i">bin</i>
              </span>
              <span> (and </span>
              <span>
                <code node-type="code">input-port?</code>
              </span>
              <span>
                <code node-type="code">binary-port?</code>
              </span>
              <span>))</span>
            </a>
          </div>
          <p node-type="paragraph">Reads X.509 certificate from the given binary input port <i node-type="i">bin</i>. The data
must be a valid X.509 certificate structure otherwise an error is signalled.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-&gt;bytevector_11">
              <span>x509-certificate-&gt;bytevector</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts the given X.509 certificate <i node-type="i">certificate</i> to a bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="write-x509-certificate_85">
              <span>write-x509-certificate</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">out</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Writes the given X.509 certificate into <i node-type="i">out</i> if specified, otherwise
<code node-type="code">(current-output-port)</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-expired?_12">
              <span>x509-certificate-expired?</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>) :optional when</span>
            </a>
          </div>
          <p node-type="paragraph">Checks if the given X.509 certificate is expired on the given <i node-type="i">when</i>
if specified, otherwise <code node-type="code">(current-date)</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-issuer-dn_23">
              <span>x509-certificate-issuer-dn</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves IssuerDn of the given <i node-type="i">certificate</i> as X.509 name.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-subject-dn_44">
              <span>x509-certificate-subject-dn</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves SubjectDn of the given <i node-type="i">certificate</i> as X.509 name.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-public-key_24">
              <span>x509-certificate-public-key</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves public key of the given <i node-type="i">certificate</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-validity_47">
              <span>x509-certificate-validity</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves validity of the given <i node-type="i">certificate</i> as X.509 validity.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-serial-number_39">
              <span>x509-certificate-serial-number</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves serial number of the given <i node-type="i">certificate</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-version_49">
              <span>x509-certificate-version</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves version of the given <i node-type="i">certificate</i>.<br>The returning value indicates the version number, for example,
v1 certificate then the procedure returns <code node-type="code">1</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-signature_40">
              <span>x509-certificate-signature</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves signature of the given <i node-type="i">certificate</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-signature-algorithm_41">
              <span>x509-certificate-signature-algorithm</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves signature algorithm of the given <i node-type="i">certificate</i> as X.509
algorithm identifier.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-extensions_13">
              <span>x509-certificate-extensions</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves extensions of the given <i node-type="i">certificate</i> as a list of X.509 extension.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="validate-x509-certificate_7">
              <span>validate-x509-certificate</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">validator</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Validates the given <i node-type="i">certificate</i> against the given <i node-type="i">validator</i>.<br><i node-type="i">validator</i> must be a procedure accepts one argument, <i node-type="i">certificate</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-signature-validator_42">
              <span>x509-certificate-signature-validator</span>
              <span> (</span>
              <span>
                <i node-type="i">public-key</i>
              </span>
              <span>
                <code node-type="code">public-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a signature validator.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-validity-validator_48">
              <span>x509-certificate-validity-validator</span>
              <span> :optional </span>
              <span>
                <i node-type="i">when</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a validity validator.<br>Optional argument <i node-type="i">when</i> specifies in which period of time the certificate
validity. Default value is <code node-type="code">(current-date)</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-signed-by?_43">
              <span>x509-certificate-signed-by?</span>
              <span> (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ca-certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">t</code> if the given <i node-type="i">certificate</i> is signed by the <i node-type="i">ca-certificate</i>,
otherwise <code node-type="code">#t</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revoked?_38">
              <span>x509-certificate-revoked?</span>
              <span>  (</span>
              <span>
                <i node-type="i">certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">ca-certificate</i>
              </span>
              <span>
                <code node-type="code">x509-certificate?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">date</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Checks if the given <i node-type="i">certificate</i> is revoked on the given <i node-type="i">crl</i>.<br>If the optional argument <i node-type="i">date</i> is provided, then the procedure checks on
the given date. Default value is <code node-type="code">(current-date)</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-template?_46">
              <span>x509-certificate-template?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 certificate template, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Macro</span>
            <a name="x509-certificate-template-builder_45">
              <span>x509-certificate-template-builder</span>
              <span> (</span>
              <span>
                <i node-type="i">field</i>
              </span>
              <span>
                <i node-type="i">value</i>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Builds an X.509 certificate template. <i node-type="i">field</i> and its <i node-type="i">value</i> must
be one or more of the followings:</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">issuer-dn</code>
            </dt>
            <dd>
              <p node-type="paragraph">X.509 name, represents IssuerDn. Required.</p>
            </dd>
            <dt>
              <code node-type="code">subject-dn</code>
            </dt>
            <dd>
              <p node-type="paragraph">X.509 name, represents SubjectDn. Required.</p>
            </dd>
            <dt>
              <code node-type="code">serial-number</code>
            </dt>
            <dd>
              <p node-type="paragraph">Integer, represents serial number. Required.</p>
            </dd>
            <dt>
              <code node-type="code">not-before</code>
            </dt>
            <dd>
              <p node-type="paragraph">Date, represents not before. Required.</p>
            </dd>
            <dt>
              <code node-type="code">not-after</code>
            </dt>
            <dd>
              <p node-type="paragraph">Date, represents not after. Required.</p>
            </dd>
            <dt>
              <code node-type="code">public-key</code>
            </dt>
            <dd>
              <p node-type="paragraph">Public key of the certificate. Required.</p>
            </dd>
            <dt>
              <code node-type="code">issuer-unique-id</code>
            </dt>
            <dd>
              <p node-type="paragraph">Bytevector, represents issuer unique Id. Optional.</p>
            </dd>
            <dt>
              <code node-type="code">subject-unique-id</code>
            </dt>
            <dd>
              <p node-type="paragraph">Bytevector, represents subject unique Id. Optional.</p>
            </dd>
            <dt>
              <code node-type="code">extentions</code>
            </dt>
            <dd>
              <p node-type="paragraph">List of X.509 extensions. Optional.</p>
            </dd>
          </dl>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="sign-x509-certificate-template_106">
              <span>sign-x509-certificate-template</span>
              <span> (</span>
              <span>
                <i node-type="i">template</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-template?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">aid</i>
              </span>
              <span> (or </span>
              <span>
                <code node-type="code">string?</code>
              </span>
              <span>
                <code node-type="code">x509-algorithm-identifier?</code>
              </span>
              <span>)) (</span>
              <span>
                <i node-type="i">private-key</i>
              </span>
              <span>
                <code node-type="code">private-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Signs the given <i node-type="i">template</i> with <i node-type="i">aid</i> algorithm and <i node-type="i">private-key</i>, then
returns X.509 certificate.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-CSR">X.509 CSR</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request?_62">
              <span>x509-certification-request?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 certificate, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="bytevector-&gt;x509-certification-request_127">
              <span>bytevector-&gt;x509-certification-request</span>
              <span> (</span>
              <span>
                <i node-type="i">bv</i>
              </span>
              <span>
                <code node-type="code">bygevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts the given bytevector <i node-type="i">bv</i> to X.509 CSR. The bytevector
must be a valid X.509 CSR otherwise an error is signalled.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="read-x509-certification-request_58">
              <span>read-x509-certification-request</span>
              <span> (</span>
              <span>
                <i node-type="i">bin</i>
              </span>
              <span> (and </span>
              <span>
                <code node-type="code">input-port?</code>
              </span>
              <span>
                <code node-type="code">binary-port?</code>
              </span>
              <span>))</span>
            </a>
          </div>
          <p node-type="paragraph">Reads X.509 CSR from the given binary input port <i node-type="i">bin</i>. The data
must be a valid X.509 CSR structure otherwise an error is signalled.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-&gt;bytevector_52">
              <span>x509-certification-request-&gt;bytevector</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts the given X.509 CSR <i node-type="i">csr</i> to a bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="write-x509-certification-request_87">
              <span>write-x509-certification-request</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">out</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Writes the given X.509 CSR into <i node-type="i">out</i> if specified, otherwise
<code node-type="code">(current-output-port)</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-version_61">
              <span>x509-certification-request-version</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves version of the given <i node-type="i">csr</i>.<br>The returning value indicates the version number, for example,
v1 certificate then the procedure returns <code node-type="code">1</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-subject_58">
              <span>x509-certification-request-subject</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves SubjectDn of the given <i node-type="i">csr</i> as X.509 name.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-public-key_54">
              <span>x509-certification-request-public-key</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves public key of the given <i node-type="i">csr</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-attributes_53">
              <span>x509-certification-request-attributes</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves list of attributes of the given <i node-type="i">csr</i> as list of X.509 attributes.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-signature_55">
              <span>x509-certification-request-signature</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves signature of the given <i node-type="i">csr</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-signature-algorithm_56">
              <span>x509-certification-request-signature-algorithm</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves signature algorithm of the given <i node-type="i">csr</i> as X.509
algorithm identifier.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="validate-x509-certification-request_9">
              <span>validate-x509-certification-request</span>
              <span> (</span>
              <span>
                <i node-type="i">csr</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">validator</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Validates the given <i node-type="i">csr</i> against the given <i node-type="i">validator</i>.<br><i node-type="i">validator</i> must be a procedure accepts one argument, <i node-type="i">csr</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-signature-validator_57">
              <span>x509-certification-request-signature-validator</span>
            </a>
          </div>
          <p node-type="paragraph">X.509 CSR signature validator. It validates the signature of the target
X.509 CSR.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certification-request-template?_60">
              <span>x509-certification-request-template?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 CSR template, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Macro</span>
            <a name="x509-certification-request-template-builder_59">
              <span>x509-certification-request-template-builder</span>
              <span> (</span>
              <span>
                <i node-type="i">field</i>
              </span>
              <span> _value) </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Builds an X.509 CSR template. <i node-type="i">field</i> and its <i node-type="i">value</i> must
be one or more of the followings:</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">subject-dn</code>
            </dt>
            <dd>
              <p node-type="paragraph">X.509 name, represents SubjectDn. Required.</p>
            </dd>
            <dt>
              <code node-type="code">attributes</code>
            </dt>
            <dd>
              <p node-type="paragraph">List of X.509 attributes. Optional.</p>
            </dd>
          </dl>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="sign-x509-certification-request-template_107">
              <span>sign-x509-certification-request-template</span>
              <span> (</span>
              <span>
                <i node-type="i">template</i>
              </span>
              <span>
                <code node-type="code">x509-certification-request-template?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">aid</i>
              </span>
              <span> (or </span>
              <span>
                <code node-type="code">string?</code>
              </span>
              <span>
                <code node-type="code">x509-algorithm-identifier?</code>
              </span>
              <span>)) (</span>
              <span>
                <i node-type="i">signing-key-pair</i>
              </span>
              <span>
                <code node-type="code">key-pair?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Signs the given <i node-type="i">template</i> with <i node-type="i">aid</i> algorithm and the private key of
the <i node-type="i">signing-key-pair</i>, then returns X.509 CSR.<br>The returning X.509 CSR contains the public key of the <i node-type="i">signing-key-pair</i>.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-CRL">X.509 CRL</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list?_37">
              <span>x509-certificate-revocation-list?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 CRL, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="bytevector-&gt;x509-certificate-revocation-list_126">
              <span>bytevector-&gt;x509-certificate-revocation-list</span>
              <span> (</span>
              <span>
                <i node-type="i">bv</i>
              </span>
              <span>
                <code node-type="code">bygevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts the given bytevector <i node-type="i">bv</i> to X.509 CRL. The bytevector
must be a valid X.509 CRL structure otherwise an error is signalled.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="read-x509-certificate-revocation-list_57">
              <span>read-x509-certificate-revocation-list</span>
              <span> (</span>
              <span>
                <i node-type="i">bin</i>
              </span>
              <span> (and </span>
              <span>
                <code node-type="code">input-port?</code>
              </span>
              <span>
                <code node-type="code">binary-port?</code>
              </span>
              <span>))</span>
            </a>
          </div>
          <p node-type="paragraph">Reads X.509 CRL from the given binary input port <i node-type="i">bin</i>. The data
must be a valid X.509 CRL structure otherwise an error is signalled.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-&gt;bytevector_25">
              <span>x509-certificate-revocation-list-&gt;bytevector</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts the given X.509 CRL <i node-type="i">crl</i> to a bytevector.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="write-x509-certificate-revocation-list_86">
              <span>write-x509-certificate-revocation-list</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">out</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Writes the given X.509 CRL into <i node-type="i">out</i> if specified, otherwise
<code node-type="code">(current-output-port)</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-issuer_27">
              <span>x509-certificate-revocation-list-issuer</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves IssuerDn of the given <i node-type="i">crl</i> as X.509 name.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-this-update_36">
              <span>x509-certificate-revocation-list-this-update</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves this update of the given <i node-type="i">crl</i> as date.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-next-update_29">
              <span>x509-certificate-revocation-list-next-update</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves next update of the given <i node-type="i">crl</i> as date.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-revoked-certificates_30">
              <span>x509-certificate-revocation-list-revoked-certificates</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves X.509 revoked certificate of the given <i node-type="i">crl</i> as list.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-crl-extensions_26">
              <span>x509-certificate-revocation-list-crl-extensions</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves X.509 extensions of the given <i node-type="i">crl</i> as X.509 extension list.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-signature-algorithm_32">
              <span>x509-certificate-revocation-list-signature-algorithm</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves signature algorithm the given <i node-type="i">crl</i> as X.509 algorithm identifier.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-signature_31">
              <span>x509-certificate-revocation-list-signature</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves signature of the given <i node-type="i">crl</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="validate-x509-certificate-revocation-list_8">
              <span>validate-x509-certificate-revocation-list</span>
              <span> (</span>
              <span>
                <i node-type="i">crl</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list?</code>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">validator</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Validates the given <i node-type="i">crl</i> with the given <i node-type="i">validator</i>, if the validation failed,
then the procedure signals an error.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-signature-validator_33">
              <span>x509-certificate-revocation-list-signature-validator</span>
              <span> (</span>
              <span>
                <i node-type="i">public-key</i>
              </span>
              <span>
                <code node-type="code">public-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a X.509 CRL validator which verifies the signature with the
given <i node-type="i">public-key</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-issuer-validator_28">
              <span>x509-certificate-revocation-list-issuer-validator</span>
              <span> (</span>
              <span>
                <i node-type="i">issuer</i>
              </span>
              <span>
                <code node-type="code">x509-name?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a X.509 CRL validator which checks if the issuer DN is
<i node-type="i">issuer</i> or not.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-revoked-certificate?_74">
              <span>x509-revoked-certificate?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 revoked certificate, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-x509-revoked-certificate_341">
              <span>make-x509-revoked-certificate</span>
              <span> (</span>
              <span>
                <i node-type="i">serial-number</i>
              </span>
              <span>
                <code node-type="code">integer?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">revocation-date</i>
              </span>
              <span>
                <code node-type="code">date?</code>
              </span>
              <span>) :optional </span>
              <span>
                <i node-type="i">extensions</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates a X.509 revoked certificate.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-revoked-certificate-serial-number_73">
              <span>x509-revoked-certificate-serial-number</span>
              <span> (</span>
              <span>
                <i node-type="i">rc</i>
              </span>
              <span>
                <code node-type="code">x509-revoked-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves serial number of the given <i node-type="i">rc</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-revoked-certificate-revocation-date_72">
              <span>x509-revoked-certificate-revocation-date</span>
              <span> (</span>
              <span>
                <i node-type="i">rc</i>
              </span>
              <span>
                <code node-type="code">x509-revoked-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves revocation date of the given <i node-type="i">rc</i> as date.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-revoked-certificate-crl-entry-extensions_71">
              <span>x509-revoked-certificate-crl-entry-extensions</span>
              <span> (</span>
              <span>
                <i node-type="i">rc</i>
              </span>
              <span>
                <code node-type="code">x509-revoked-certificate?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves CRL entry extensions of the given <i node-type="i">rc</i> as X.509 extension list.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-template?_35">
              <span>x509-certificate-revocation-list-template?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 CRL template, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-certificate-revocation-list-template-builder_34">
              <span>x509-certificate-revocation-list-template-builder</span>
              <span> (</span>
              <span>
                <i node-type="i">field</i>
              </span>
              <span>
                <i node-type="i">value</i>
              </span>
              <span>) </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Builds an X.509 CRL template. <i node-type="i">field</i> and its <i node-type="i">value</i> must be one or more
of the followings:</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">issuer-dn</code>
            </dt>
            <dd>
              <p node-type="paragraph">X.509 name, represents IssuerDn. Required.</p>
            </dd>
            <dt>
              <code node-type="code">this-update</code>
            </dt>
            <dd>
              <p node-type="paragraph">Date, represents this update. Required.</p>
            </dd>
            <dt>
              <code node-type="code">next-update</code>
            </dt>
            <dd>
              <p node-type="paragraph">Date, represents next update. Optional.</p>
            </dd>
            <dt>
              <code node-type="code">revoked-certificate</code>
            </dt>
            <dd>
              <p node-type="paragraph">A list of X.509 revoked certificate, represents revoked certificates.
Required.</p>
            </dd>
            <dt>
              <code node-type="code">crl-extensions</code>
            </dt>
            <dd>
              <p node-type="paragraph">A list of X.509 extensions, represents CRL extensions. Optional.</p>
            </dd>
          </dl>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="sign-x509-certificate-revocation-list-template_105">
              <span>sign-x509-certificate-revocation-list-template</span>
              <span> (</span>
              <span>
                <i node-type="i">template</i>
              </span>
              <span>
                <code node-type="code">x509-certificate-revocation-list-template?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">aid</i>
              </span>
              <span> (or </span>
              <span>
                <code node-type="code">string?</code>
              </span>
              <span>
                <code node-type="code">x509-algorithm-identifier</code>
              </span>
              <span>)) (</span>
              <span>
                <i node-type="i">private-key</i>
              </span>
              <span>
                <code node-type="code">private-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Signs the given <i node-type="i">template</i> with <i node-type="i">aid</i> algorithm and <i node-type="i">private-key</i>, then
returns X.509 CRL.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="Distinguished-name-DN">Distinguished name (DN)</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-name?_70">
              <span>x509-name?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 name, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-name_68">
              <span>x509-name</span>
              <span>
                <i node-type="i">component</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="list-&gt;x509-name_34">
              <span>list-&gt;x509-name</span>
              <span>
                <i node-type="i">list of component</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Creates X.509 name from the given <i node-type="i">component</i>s.</p>
          <p node-type="paragraph">A component must be a list of either:</p>
          <ul node-type="bullet-list">
            <li>
              <p node-type="paragraph">Symbol representation of well-known name, such as <code node-type="code">CN</code>, and string value</p>
            </li>
            <li>
              <p node-type="paragraph">Or string representation of OID and string value.</p>
            </li>
          </ul>
          <p node-type="paragraph">Below are the supported symbols:</p>
          <dl node-type="dlist">
            <dt>
              <code node-type="code">CN</code>
            </dt>
            <dd>
              <p node-type="paragraph">Common name</p>
            </dd>
            <dt>
              <code node-type="code">L</code>
            </dt>
            <dd>
              <p node-type="paragraph">Locality name</p>
            </dd>
            <dt>
              <code node-type="code">ST</code>
            </dt>
            <dd>
              <p node-type="paragraph">State or province name</p>
            </dd>
            <dt>
              <code node-type="code">O</code>
            </dt>
            <dd>
              <p node-type="paragraph">Origanisation name</p>
            </dd>
            <dt>
              <code node-type="code">OU</code>
            </dt>
            <dd>
              <p node-type="paragraph">Origanisation unit name</p>
            </dd>
            <dt>
              <code node-type="code">STREET</code>
            </dt>
            <dd>
              <p node-type="paragraph">Street address</p>
            </dd>
            <dt>
              <code node-type="code">DC</code>
            </dt>
            <dd>
              <p node-type="paragraph">Domain component</p>
            </dd>
            <dt>
              <code node-type="code">UID</code>
            </dt>
            <dd>
              <p node-type="paragraph">User ID</p>
            </dd>
            <dt>
              <code node-type="code">Name</code>
            </dt>
            <dd>
              <p node-type="paragraph">Name</p>
            </dd>
            <dt>
              <code node-type="code">SURNAME</code>
            </dt>
            <dd>
              <p node-type="paragraph">Surname</p>
            </dd>
            <dt>
              <code node-type="code">GIVENNAME</code>
            </dt>
            <dd>
              <p node-type="paragraph">Given name</p>
            </dd>
            <dt>
              <code node-type="code">T</code>
            </dt>
            <dd>
              <p node-type="paragraph">Title</p>
            </dd>
            <dt>
              <code node-type="code">DN</code>
            </dt>
            <dd>
              <p node-type="paragraph">DN qualifier</p>
            </dd>
            <dt>
              <code node-type="code">SERIALNUMBER</code>
            </dt>
            <dd>
              <p node-type="paragraph">Serial number</p>
            </dd>
            <dt>
              <code node-type="code">Pseudonym</code>
            </dt>
            <dd>
              <p node-type="paragraph">Pseudonym</p>
            </dd>
            <dt>
              <code node-type="code">E</code>
            </dt>
            <dd>
              <p node-type="paragraph">Email address</p>
            </dd>
          </dl>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-name-&gt;string_69">
              <span>x509-name-&gt;string</span>
              <span> (</span>
              <span>
                <i node-type="i">name</i>
              </span>
              <span>
                <code node-type="code">x509-name?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts given <i node-type="i">name</i> to string representation.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="string-&gt;x509-name_281">
              <span>string-&gt;x509-name</span>
              <span> (</span>
              <span>
                <i node-type="i">dn</i>
              </span>
              <span>
                <code node-type="code">string?</code>
              </span>
              <span>) </span>
              <span>
                <since node-type="since">
                  <span node-type="since-version" version="0.9.12">0.9.12</span>
                </since>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Converts given <i node-type="i">dn</i> to X509 names.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-validity">X.509 validity</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-validity?_77">
              <span>x509-validity?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 validity, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-x509-validity_342">
              <span>make-x509-validity</span>
              <span> (</span>
              <span>
                <i node-type="i">not-before</i>
              </span>
              <span>
                <code node-type="code">date?</code>
              </span>
              <span>) (</span>
              <span>
                <i node-type="i">not-after</i>
              </span>
              <span>
                <code node-type="code">date?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates a X.509 validity of the range of <i node-type="i">not-after</i> and <i node-type="i">not-after</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-validity-not-before_76">
              <span>x509-validity-not-before</span>
              <span> (</span>
              <span>
                <i node-type="i">validity</i>
              </span>
              <span>
                <code node-type="code">x509-validity?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves not before of <i node-type="i">validity</i> as date.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-validity-not-after_75">
              <span>x509-validity-not-after</span>
              <span> (</span>
              <span>
                <i node-type="i">validity</i>
              </span>
              <span>
                <code node-type="code">x509-validity?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves not after of <i node-type="i">validity</i> as date.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-algorithm-identifier">X.509 algorithm identifier</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-algorithm-identifier?_5">
              <span>x509-algorithm-identifier?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is x.509 algorithm identifier,
otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-x509-algorithm-identifier_336">
              <span>make-x509-algorithm-identifier</span>
              <span> (</span>
              <span>
                <i node-type="i">oid</i>
              </span>
              <span>
                <code node-type="code">string?</code>
              </span>
              <span>) :optional parameters</span>
            </a>
          </div>
          <p node-type="paragraph"><i node-type="i">oid</i> must be a valid string representaion of oid.<br>creates a x.509 algorithm identifier of _oid.<br>if optional parameter is passed, then it has to be a valid x.509 algorithm
identifier parameter.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-algorithm-identifier-oid_3">
              <span>x509-algorithm-identifier-oid</span>
              <span> (</span>
              <span>
                <i node-type="i">aid</i>
              </span>
              <span>
                <code node-type="code">x509-algorithm-identifier?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves OID of <i node-type="i">aid</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-algorithm-identifier-parameters_4">
              <span>x509-algorithm-identifier-parameters</span>
              <span> (</span>
              <span>
                <i node-type="i">aid</i>
              </span>
              <span>
                <code node-type="code">x509-algorithm-identifier?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves parameters of <i node-type="i">aid</i>.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-subject-public-key-info">X.509 subject public key info</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="subject-public-key-info?_319">
              <span>subject-public-key-info?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is subject public key info, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="subject-public-key-info-&gt;public-key_318">
              <span>subject-public-key-info-&gt;public-key</span>
              <span> (</span>
              <span>
                <i node-type="i">spki</i>
              </span>
              <span>
                <code node-type="code">subject-public-key-info?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts given <i node-type="i">spki</i> to a public key.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="public-key-&gt;subject-public-key-info_177">
              <span>public-key-&gt;subject-public-key-info</span>
              <span> (</span>
              <span>
                <i node-type="i">public-key</i>
              </span>
              <span>
                <code node-type="code">public-key?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts given <i node-type="i">public-key</i> to a subject public key info.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="bytevector-&gt;subject-public-key-info_120">
              <span>bytevector-&gt;subject-public-key-info</span>
              <span> (</span>
              <span>
                <i node-type="i">bv</i>
              </span>
              <span>
                <code node-type="code">bytevector?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts given <i node-type="i">bv</i> to a subject public key info.<br>The bytevector must be a valid SubjectPublicKeyInfo structure. Otherwise,
an error is signalled.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="subject-public-key-info-&gt;bytevector_317">
              <span>subject-public-key-info-&gt;bytevector</span>
              <span> (</span>
              <span>
                <i node-type="i">spki</i>
              </span>
              <span>
                <code node-type="code">subject-public-key-info?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts given <i node-type="i">spki</i> to a bytevector.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-attribute">X.509 attribute</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-attribute?_10">
              <span>x509-attribute?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 attribute, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-attribute-type_8">
              <span>x509-attribute-type</span>
              <span> (</span>
              <span>
                <i node-type="i">attr</i>
              </span>
              <span>
                <code node-type="code">x509-attribute?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves type of the <i node-type="i">attr</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-attribute-values_9">
              <span>x509-attribute-values</span>
              <span> (</span>
              <span>
                <i node-type="i">attr</i>
              </span>
              <span>
                <code node-type="code">x509-attribute?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves values of the <i node-type="i">attr</i>. The retrieved value may not be
usable as it is.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-attribute-of_7">
              <span>x509-attribute-of</span>
              <span>
                <i node-type="i">oid</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph"><i node-type="i">oid</i> must be a string representaion of OID or object identifier.<br>Returns a predicate for a X.509 attribute list. The predicate
checks if the given X.509 attribute has <i node-type="i">oid</i> or not.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-x509-challenge-password-attribute_339">
              <span>make-x509-challenge-password-attribute</span>
              <span> (</span>
              <span>
                <i node-type="i">password</i>
              </span>
              <span>
                <code node-type="code">string?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Creates PKCS#9 challenge password attribute of the value <i node-type="i">password</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="make-x509-extension-request-attribute_340">
              <span>make-x509-extension-request-attribute</span>
              <span>
                <i node-type="i">x509-extension</i>
              </span>
              <span>
                <i node-type="i">...</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph"><i node-type="i">x509-extension</i> must be X.509 extension.<br>Creates PKCS#9 extension request attribute of the value <i node-type="i">x509-extension</i>s.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-attribute-&gt;x509-extension-list_6">
              <span>x509-attribute-&gt;x509-extension-list</span>
              <span> (</span>
              <span>
                <i node-type="i">attr</i>
              </span>
              <span>
                <code node-type="code">x509-attribute</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Converts PKCS#9 extension request attribute to list of X.509 extensions.<br>If the <i node-type="i">attr</i> does not have appropriate attribute type, the procedure
signals an error.</p>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*pkcs-9:channelge-password*_178">
              <span>*pkcs-9:channelge-password*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*pkcs-9:extenion-request*_179">
              <span>*pkcs-9:extenion-request*</span>
            </a>
          </div>
          <p node-type="paragraph">The above object identifiers can be use for <code node-type="code">x509-attribute-of</code> procedure.</p>
        </section>
        <section node-type="section">
          <h3 node-type="header-3">
            <a name="X509-extension">X.509 extension</a>
          </h3>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-extension?_67">
              <span>x509-extension?</span>
              <span>
                <i node-type="i">obj</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is X.509 extension, otherwise <code node-type="code">#f</code>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-extension-id_64">
              <span>x509-extension-id</span>
              <span> (</span>
              <span>
                <i node-type="i">ext</i>
              </span>
              <span>
                <code node-type="code">x509-extension?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves id of the <i node-type="i">ext</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-extension-critical?_63">
              <span>x509-extension-critical?</span>
              <span> (</span>
              <span>
                <i node-type="i">ext</i>
              </span>
              <span>
                <code node-type="code">x509-extension?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves critical of the <i node-type="i">ext</i>.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-extension-value_66">
              <span>x509-extension-value</span>
              <span> (</span>
              <span>
                <i node-type="i">ext</i>
              </span>
              <span>
                <code node-type="code">x509-extension?</code>
              </span>
              <span>)</span>
            </a>
          </div>
          <p node-type="paragraph">Retrieves value of the <i node-type="i">ext</i>.</p>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:authority-key-identifier*_103">
              <span>*extension:authority-key-identifier*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:subject-key-identifier*_126">
              <span>*extension:subject-key-identifier*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:key-usage*_118">
              <span>*extension:key-usage*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:private-key-usage-period*_122">
              <span>*extension:private-key-usage-period*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:certificate-policies*_106">
              <span>*extension:certificate-policies*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:policy-mappings*_121">
              <span>*extension:policy-mappings*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:subject-alt-name*_123">
              <span>*extension:subject-alt-name*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:issuer-alt-name*_116">
              <span>*extension:issuer-alt-name*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:subject-directory-attributes*_124">
              <span>*extension:subject-directory-attributes*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:basic-constraints*_104">
              <span>*extension:basic-constraints*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:name-constraints*_119">
              <span>*extension:name-constraints*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:policy-constraints*_120">
              <span>*extension:policy-constraints*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:ext-key-usage*_111">
              <span>*extension:ext-key-usage*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:crl-distribution-points*_107">
              <span>*extension:crl-distribution-points*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:inhibit-any-policy*_114">
              <span>*extension:inhibit-any-policy*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:freshest-crl*_112">
              <span>*extension:freshest-crl*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:authority-info-access*_102">
              <span>*extension:authority-info-access*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:subject-info-access*_125">
              <span>*extension:subject-info-access*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:crl-number*_108">
              <span>*extension:crl-number*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:delta-crl-indicator*_110">
              <span>*extension:delta-crl-indicator*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:issuing-distribution-point*_117">
              <span>*extension:issuing-distribution-point*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:crl-reason*_109">
              <span>*extension:crl-reason*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:certificate-issuer*_105">
              <span>*extension:certificate-issuer*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:hold-instruction-code*_113">
              <span>*extension:hold-instruction-code*</span>
            </a>
          </div>
          <div node-type="define" class="define">
            <span>Object identifier</span>
            <a name="*extension:invalidity-date*_115">
              <span>*extension:invalidity-date*</span>
            </a>
          </div>
          <p node-type="paragraph">Object identifiers of X.509 extension. The name must be descritive enough
to see which extension's OID it is.</p>
          <div node-type="define" class="define">
            <span>Function</span>
            <a name="x509-extension-of_65">
              <span>x509-extension-of</span>
              <span>
                <i node-type="i">oid</i>
              </span>
            </a>
          </div>
          <p node-type="paragraph"><i node-type="i">oid</i> must be a string representaion of OID or object identifier.<br>Creates a predicate for a list of X.509 extensions.</p>
          <!-- // TBD
x509-general-name?
rfc822-name->general-name
dns-name->general-name
ip-address->general-name
uri->general-name
directory-name->general-name
registered-id->general-name

x509-general-names?
list->x509-general-names
x509-general-names

make-x509-subject-alternative-name-extension
x509-subject-alternative-name-extension->x509-general-names
make-x509-issuer-alternative-name-extension
x509-issuer-alternative-name-extension->x509-general-names

x509-authority-key-identifier?
make-x509-authority-key-identifier
x509-authority-key-identifier-key-identifier
x509-authority-key-identifier-authority-cert-issuer
x509-authority-key-identifier-authority-cert-serial-number

make-x509-authority-key-identifier-extension
x509-authority-key-identifier-extension->x509-authority-key-identifier

make-x509-subject-key-identifier-extension
x509-subject-key-identifier-extension->subject-key-identifier

x509-key-usages 
x509-key-usages?
make-x509-key-usage-extension
x509-key-usage-extension->x509-key-usages

x509-private-key-usage-period?
make-x509-private-key-usage-period
x509-private-key-usage-period-not-before
x509-private-key-usage-period-not-after

make-x509-private-key-usage-period-extension
x509-private-key-usage-period-extension->x509-private-key-usage-period

x509-policy-qualifier-info?
x509-policy-qualifier-info-id
x509-policy-qualifier-info-qualifier
make-x509-policy-qualifier-info
x509-policy-qualifier-info->policy-qualifier-info

x509-notice-reference?
x509-notice-reference-organization
x509-notice-reference-notice-numbers
make-x509-notice-reference

x509-user-notice?
x509-user-notice-ref
x509-user-notice-explicit-text
make-x509-user-notice

x509-policy-information?
x509-policy-information-identifier
x509-policy-information-qualifiers
make-x509-policy-information
*policy-qualifier-type:cps*
*policy-qualifier-type:unotice*

make-x509-certificate-policies-extension
x509-certificate-policies-extension->x509-policy-informations

x509-basic-constraints?
make-x509-basic-constraints
x509-basic-constraints-ca?
x509-basic-constraints-path-length-constraint

make-x509-basic-constraints-extension
x509-basic-constraints-extension->x509-basic-constraints
-->
        </section>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.keystoress">Keystore library - (sagittarius crypto keystores)</a>
        </h2>
        <p node-type="paragraph">The keystore library provides keystore operation. More precisely, PKCS#12.</p>
        <p node-type="paragraph">PKCS#12 keystore is very flexible format, and there's no standard
convension, but just de-fact. For example, PKCS#12 itself doesn't
require the entry to be key/value, however most of the existing
library uses the format as key/value map.</p>
        <p node-type="paragraph">This library provides the de-fact convension layer. If you want to
use raw PKCS#12 format, see <code node-type="code">(sagittarius crypto pkcs keystore)</code>.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto keystores)_93">
            <span>(sagittarius crypto keystores)</span>
          </a>
        </div>
        <p node-type="paragraph">The keystore library, this library exports the procedures listed
blow sections.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore?_105">
            <span>pkcs12-keystore?</span>
            <span>
              <i node-type="i">obj</i>
            </span>
          </a>
        </div>
        <p node-type="paragraph">Returns <code node-type="code">#t</code> if the given <i node-type="i">obj</i> is PKCS#12 keystore, otherwise <code node-type="code">#f</code>.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="make-pkcs12-keystore_245">
            <span>make-pkcs12-keystore</span>
          </a>
        </div>
        <p node-type="paragraph">Creates an empty PKCS#12 keystore.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="read-pkcs12-keystore_46">
            <span>read-pkcs12-keystore</span>
            <span> (</span>
            <span>
              <i node-type="i">password</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>) :optiona </span>
            <span>
              <i node-type="i">in</i>
            </span>
          </a>
        </div>
        <p node-type="paragraph">Reads PKCS#12 keystore from <i node-type="i">in</i>, if provided, otherwise <code node-type="code">(current-input-port)</code>.</p>
        <p node-type="paragraph">The <i node-type="i">password</i> must be a valid password for the reading PKCS#12, otherwise
an error is signalled.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="bytevector-&gt;pkcs12-keystore_115">
            <span>bytevector-&gt;pkcs12-keystore</span>
            <span> (</span>
            <span>
              <i node-type="i">bv</i>
            </span>
            <span>
              <code node-type="code">bytevector?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">password</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Converts given <i node-type="i">bv</i> to PKCS#12 keystore.</p>
        <p node-type="paragraph">The <i node-type="i">password</i> must be a valid password for the reading PKCS#12, otherwise
an error is signalled.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-&gt;bytevector_88">
            <span>pkcs12-keystore-&gt;bytevector</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">password</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Converts the given <i node-type="i">ks</i> to a bytevector using the given <i node-type="i">password</i> as
both integrity and privacy exchange key.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="write-pkcs12-keystore_77">
            <span>write-pkcs12-keystore</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">password</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>) :optiona </span>
            <span>
              <i node-type="i">out</i>
            </span>
          </a>
        </div>
        <p node-type="paragraph">Writes the given <i node-type="i">ks</i> to <i node-type="i">out</i> if provided, otherwise <code node-type="code">(current-output-port)</code>,
using the given <i node-type="i">password</i> as both integrity and privacy exchange key.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-private-key-ref_100">
            <span>pkcs12-keystore-private-key-ref</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">alias</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">password</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Retrieves a private key associated to <i node-type="i">alias</i> from <i node-type="i">ks</i> decrypting with
the given <i node-type="i">password</i>.</p>
        <p node-type="paragraph">If the <i node-type="i">alias</i> doesn't exist in the <i node-type="i">ks</i>, then returns <code node-type="code">#f</code>.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-private-key-set!_101">
            <span>pkcs12-keystore-private-key-set!</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">alias</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">key</i>
            </span>
            <span>
              <code node-type="code">private-key?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">password</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>) </span>
            <span>
              <i node-type="i">certs</i>
            </span>
          </a>
        </div>
        <p node-type="paragraph"><i node-type="i">certs</i> must be a list of X.509 certificates.</p>
        <p node-type="paragraph">Stores the given <i node-type="i">key</i> into the <i node-type="i">ks</i> associating with <i node-type="i">alias</i>. The
<i node-type="i">key</i> is encrypted with the <i node-type="i">password</i>.</p>
        <p node-type="paragraph">The <i node-type="i">certs</i> must be a valid (chain) certificate(s) for the given <i node-type="i">key</i>.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-certificate-ref_91">
            <span>pkcs12-keystore-certificate-ref</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">alias</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Retrieves a certificate associated to <i node-type="i">alias</i> from <i node-type="i">ks</i>.</p>
        <p node-type="paragraph">If the <i node-type="i">alias</i> doesn't exist in the <i node-type="i">ks</i>, then returns <code node-type="code">#f</code>.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-certificate-set!_92">
            <span>pkcs12-keystore-certificate-set!</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">alias</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">cert</i>
            </span>
            <span>
              <code node-type="code">x509-certificate?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Stores the given <i node-type="i">cert</i> into the given <i node-type="i">ks</i> associating with <i node-type="i">alias</i>.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-certificate-chain-ref_90">
            <span>pkcs12-keystore-certificate-chain-ref</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">alias</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Retrieves certificate chain associated to <i node-type="i">alias</i> from the <i node-type="i">ks</i>.</p>
        <p node-type="paragraph">If there's no certificate associated to <i node-type="i">alias</i>, then it returns <code node-type="code">()</code>.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-delete-entry!_96">
            <span>pkcs12-keystore-delete-entry!</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>) (</span>
            <span>
              <i node-type="i">alias</i>
            </span>
            <span>
              <code node-type="code">string?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Removes the entry associated to <i node-type="i">alias</i> from the <i node-type="i">ks</i>.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcs12-keystore-delete-all-entries!_94">
            <span>pkcs12-keystore-delete-all-entries!</span>
            <span> (</span>
            <span>
              <i node-type="i">ks</i>
            </span>
            <span>
              <code node-type="code">pkcs12-keystore?</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">Removes all entries from the <i node-type="i">ks</i>.</p>
      </section>
      <section node-type="section">
        <h2 node-type="header-2">
          <a name="sagittarius.crypto.kdfs">KDF library - (sagittarius crypto kdfs)</a>
        </h2>
        <p node-type="paragraph">The KDF, Key Derivation Function, library provides various KDF algorithms.</p>
        <div node-type="define" class="define">
          <span>Library</span>
          <a name="(sagittarius crypto kdfs)_91">
            <span>(sagittarius crypto kdfs)</span>
          </a>
        </div>
        <p node-type="paragraph">The KDF library, this library exports the procedures listed below sections.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pbkdf-1_68">
            <span>pbkdf-1</span>
            <span>
              <i node-type="i">P</i>
            </span>
            <span>
              <i node-type="i">S</i>
            </span>
            <span>
              <i node-type="i">c</i>
            </span>
            <span>
              <i node-type="i">dk-len</i>
            </span>
            <span> :key (</span>
            <span>
              <i node-type="i">digest</i>
            </span>
            <span>
              <code node-type="code">*digest:sha-1*</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">_P_and <i node-type="i">S</i> must be bytevectors.<br><i node-type="i">c</i> and <i node-type="i">dk-len</i> must be non-negative integers.</p>
        <p node-type="paragraph">PBKDF1</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pbkdf-2_70">
            <span>pbkdf-2</span>
            <span>
              <i node-type="i">P</i>
            </span>
            <span>
              <i node-type="i">S</i>
            </span>
            <span>
              <i node-type="i">c</i>
            </span>
            <span>
              <i node-type="i">dk-len</i>
            </span>
            <span> :key (</span>
            <span>
              <i node-type="i">prf</i>
            </span>
            <span>
              <code node-type="code">*hmac-sha1-prf*</code>
            </span>
            <span>)</span>
          </a>
        </div>
        <p node-type="paragraph">_P_and <i node-type="i">S</i> must be bytevectors.<br><i node-type="i">c</i> and <i node-type="i">dk-len</i> must be non-negative integers.</p>
        <p node-type="paragraph">PBKDF2</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="mac-&gt;prf-provider_0">
            <span>mac-&gt;prf-provider</span>
            <span>
              <i node-type="i">scheme</i>
            </span>
            <span> . </span>
            <span>
              <i node-type="i">opts</i>
            </span>
          </a>
        </div>
        <p node-type="paragraph"><i node-type="i">scheme</i> must be a MAC scheme, e.g. <code node-type="code">*mac:hmac*</code>.</p>
        <p node-type="paragraph">Provides a PRF generator which accepts <i node-type="i">S</i>, secret,
based on the given <i node-type="i">scheme</i>.<br>The <i node-type="i">opts</i> will be passed to the MAC generation.</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="hkdf_51">
            <span>hkdf</span>
            <span>
              <i node-type="i">digest</i>
            </span>
            <span>
              <i node-type="i">ikm</i>
            </span>
            <span>
              <i node-type="i">salt</i>
            </span>
            <span>
              <i node-type="i">info</i>
            </span>
            <span>
              <i node-type="i">dk-len</i>
            </span>
          </a>
        </div>
        <p node-type="paragraph">HKDF</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="pkcf12-kdf_75">
            <span>pkcf12-kdf</span>
            <span>
              <i node-type="i">digest</i>
            </span>
            <span>
              <i node-type="i">pw</i>
            </span>
            <span>
              <i node-type="i">salt</i>
            </span>
            <span>
              <i node-type="i">iteration</i>
            </span>
            <span>
              <i node-type="i">dk-len</i>
            </span>
          </a>
        </div>
        <p node-type="paragraph">PKCS12 KDF</p>
        <div node-type="define" class="define">
          <span>Function</span>
          <a name="scrypt_8">
            <span>scrypt</span>
            <span>
              <i node-type="i">P</i>
            </span>
            <span>
              <i node-type="i">S</i>
            </span>
            <span>
              <i node-type="i">N</i>
            </span>
            <span>
              <i node-type="i">r</i>
            </span>
            <span>
              <i node-type="i">p</i>
            </span>
            <span>
              <i node-type="i">dk-len</i>
            </span>
            <span>
              <since node-type="since">
                <span node-type="since-version" version="0.9.13">0.9.13</span>
              </since>
            </span>
          </a>
        </div>
        <p node-type="paragraph">scrypt, defined in <a href="https://datatracker.ietf.org/doc/html/rfc7914">RFC 7914</a>.</p>
        <p node-type="paragraph"><i node-type="i">P</i> and <i node-type="i">S</i> must be bytevectors, represents password and salt.<br><i node-type="i">N</i> must be an integer, represents cost parameter.<br><i node-type="i">r</i> must be an integer, represents block size.<br><i node-type="i">p</i> must be an integer, represents parallelization parameter.</p>
      </section>
    </section>
    <p node-type="paragraph" class="navigation-container">
      <a href="./lib.sagittarius.generators.html">(sagittarius generators) - Generators</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./lib.sagittarius.atomic.html">(sagittarius atomic) - Atomic operation</a>
    </p>
    <div node-type="section">
      <hr>
      <p node-type="paragraph" class="author footer">This document was generated by <i node-type="i">Takashi Kato</i> with Sagittarius gendoc.<br>Generated date: <i node-type="i">2025-12-25T00:11:50Z</i></p>
    </div>
  </body>
</html>