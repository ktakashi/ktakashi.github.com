<html>
  <head>
    <meta charset="utf-8">
    <meta http-eqiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../lib/style.css">
    <title>Sagittarius Users' Reference</title>
  </head>
  <body>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section754.html">(rfc websocket) - WebSocket</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section756.html">(rfc zlib) - zlib compression library</a>
    </p>
    <section node-type="section">
      <h2 node-type="header-2">
        <a name="rfc.x.509">(rfc x.509) - X.509 certificate utility library</a>
      </h2>
      <p node-type="paragraph">This library does not support whole feature of X.509, it just parse and verify
a message and signature. So it can not verify certificate itself.</p>
      <div node-type="define" class="define">
        <span>Library</span>
        <a name="(rfc x.509)_53">
          <span>(rfc x.509)</span>
        </a>
      </div>
      <p node-type="paragraph">Exports X.509 utility procedures.</p>
      <div node-type="define" class="define">
        <span>Generic</span>
        <a name="make-x509-certificate_302">
          <span>make-x509-certificate</span>
          <span>
            <i node-type="i">(in</i>
          </span>
          <span>
            <i node-type="i"><port>)</i>
          </span>
        </a>
      </div>
      <div node-type="define" class="define">
        <span>Generic</span>
        <a name="make-x509-certificate_301">
          <span>make-x509-certificate</span>
          <span>
            <i node-type="i">(sequence</i>
          </span>
          <span>
            <i node-type="i">&lt;asn.1-sequence&gt;)</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Creates an X.509 certificate object from given binary input port or ASN.1
sequence object (second form).</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate?_48">
          <span>x509-certificate?</span>
          <span>
            <i node-type="i">o</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return #t if the <i node-type="i">o</i> is X.509 certificate object, otherwise #f.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-version_20">
          <span>x509-certificate-get-version</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return version of given X.509 certificate object.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-serial-number_16">
          <span>x509-certificate-get-serial-number</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return serial number of given X.509 certificate object.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-issuer-dn_12">
          <span>x509-certificate-get-issuer-dn</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return issuer DN of given X.509 certificate object as X.509 principal.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-subject-dn_19">
          <span>x509-certificate-get-subject-dn</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return subject DN of given X.509 certificate object as X.509 principal.</p>
      <p node-type="paragraph">NOTE: These Issuer DN and Subject DN getters return &lt;x.509-principal&gt; object,
however I did not implement any utility for this class, so it's just useless
for now.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-not-before_14">
          <span>x509-certificate-get-not-before</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return start date of given X.509 certificate object.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-not-after_13">
          <span>x509-certificate-get-not-after</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return end date of given X.509 certificate object.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-signature_17">
          <span>x509-certificate-get-signature</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return signature of given X.509 certificate object.</p>
      <p node-type="paragraph">NOTE: This signature is not for <code node-type="code">verify</code> described below.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-signature-algorithm_18">
          <span>x509-certificate-get-signature-algorithm</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return signature algorithm of given X.509 certificate object as an OID
string.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="x509-certificate-get-public-key_15">
          <span>x509-certificate-get-public-key</span>
          <span>
            <i node-type="i">x509</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Return public key of given X.509 certificate object. The return value is
<code node-type="code">&lt;public-key&gt;</code> described in the section
<a href="section79.html#crypto">(crypto) - Cryptographic library</a>.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="verify_34">
          <span>verify</span>
          <span>
            <i node-type="i">x509</i>
          </span>
          <span>
            <i node-type="i">message</i>
          </span>
          <span>
            <i node-type="i">signature</i>
          </span>
          <span> _</span>
        </a>
      </div>
      <p node-type="paragraph">_ <i node-type="i">:key</i> <i node-type="i">(verify</i> <i node-type="i">pkcs1-emsa-v1.5-verify)</i> <i node-type="i">(hash</i> <i node-type="i">SHA-1)</i></p>
      <p node-type="paragraph"><i node-type="i">message</i> and <i node-type="i">signature</i> must be bytevector.</p>
      <p node-type="paragraph">Verify given <i node-type="i">message</i> with <i node-type="i">signature</i> and <i node-type="i">x509</i> certificate.</p>
      <p node-type="paragraph">This procedure uses the <code node-type="code">verify</code> procedure in <code node-type="code">(crypto)</code> library. The
keyword arguments will be passed to it. For more detail, see
<a href="section79.html#crypto">(crypto) - Cryptographic library</a>.</p>
      <div node-type="define" class="define">
        <span>Function</span>
        <a name="check-validity_72">
          <span>check-validity</span>
          <span>
            <i node-type="i">x509</i>
          </span>
          <span>
            <i node-type="i">:optional</i>
          </span>
          <span>
            <i node-type="i">(date</i>
          </span>
          <span>
            <i node-type="i">(current-date))</i>
          </span>
        </a>
      </div>
      <p node-type="paragraph">Validate if the given certificate is valid in given <i node-type="i">date</i>. Return #t
if it's valid, otherwise raises <code node-type="code">&amp;assertion</code>.</p>
    </section>
    <p node-type="paragraph" class="navigation-container">
      <a href="./section754.html">(rfc websocket) - WebSocket</a>
      <a href="../sagittarius-online-ref.html">Top</a>
      <a href="./section756.html">(rfc zlib) - zlib compression library</a>
    </p>
    <div node-type="section">
      <hr>
      <p node-type="paragraph" class="author footer">This document was generated by <i node-type="i">Takashi Kato</i> with Sagittarius gendoc.<br>Generated date: <i node-type="i">2023-06-18T11:03:41+0200</i></p>
    </div>
  </body>
</html>